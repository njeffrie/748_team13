   1               		.file	"bmac.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
  10               		.text
  11               	.Ltext0:
 341               	.global	rf_rx_callback
 343               	rf_rx_callback:
 344               		.stabd	46,0,0
   1:../../../../src/net/bmac/rf231_soc/bmac.c **** /******************************************************************************
   2:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  Nano-RK, a real-time operating system for sensor networks.
   3:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  Copyright (C) 2007, Real-Time and Multimedia Lab, Carnegie Mellon University
   4:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  All rights reserved.
   5:../../../../src/net/bmac/rf231_soc/bmac.c ****  *
   6:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  This is the Open Source Version of Nano-RK included as part of a Dual
   7:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  Licensing Model. If you are unsure which license to use please refer to:
   8:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  http://www.nanork.org/nano-RK/wiki/Licensing
   9:../../../../src/net/bmac/rf231_soc/bmac.c ****  *
  10:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  This program is free software: you can redistribute it and/or modify
  11:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  it under the terms of the GNU General Public License as published by
  12:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  the Free Software Foundation, version 2.0 of the License.
  13:../../../../src/net/bmac/rf231_soc/bmac.c ****  *
  14:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  This program is distributed in the hope that it will be useful,
  15:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  but WITHOUT ANY WARRANTY; without even the implied warranty of
  16:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  17:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  GNU General Public License for more details.
  18:../../../../src/net/bmac/rf231_soc/bmac.c ****  *
  19:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  You should have received a copy of the GNU General Public License
  20:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  21:../../../../src/net/bmac/rf231_soc/bmac.c ****  *
  22:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  Contributing Authors (specific to this file):
  23:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  Anthony Rowe
  24:../../../../src/net/bmac/rf231_soc/bmac.c ****  *******************************************************************************/
  25:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  26:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  27:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  28:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <include.h>
  29:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <ulib.h>
  30:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdlib.h>
  31:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/sleep.h>
  32:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/wdt.h>
  33:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/eeprom.h>
  34:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdio.h>
  35:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/interrupt.h>
  36:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk.h>
  37:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_events.h>
  38:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_timer.h>
  39:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_error.h>
  40:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_reserve.h>
  41:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <bmac.h>
  42:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_cfg.h>
  43:../../../../src/net/bmac/rf231_soc/bmac.c **** #include <basic_rf.h>
  44:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  45:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  46:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifndef BMAC_STACKSIZE
  47:../../../../src/net/bmac/rf231_soc/bmac.c **** #define BMAC_STACKSIZE 128
  48:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
  49:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  50:../../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_task_type bmac_task;
  51:../../../../src/net/bmac/rf231_soc/bmac.c **** static NRK_STK bmac_task_stack[BMAC_STACKSIZE];
  52:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  53:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  54:../../../../src/net/bmac/rf231_soc/bmac.c **** //#define DEBUG
  55:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint32_t rx_failure_cnt;
  56:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  57:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t tx_data_ready;
  58:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t rx_buf_empty;
  59:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t bmac_running;
  60:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t pkt_got_ack;
  61:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t g_chan;
  62:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t is_enabled;
  63:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  64:../../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t _bmac_check_period;
  65:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  66:../../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t cca_active;
  67:../../../../src/net/bmac/rf231_soc/bmac.c **** static int8_t tx_reserve;
  68:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  69:../../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t dummy_t;
  70:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  71:../../../../src/net/bmac/rf231_soc/bmac.c **** /**
  72:../../../../src/net/bmac/rf231_soc/bmac.c ****  *  This is a callback if you require immediate response to a packet
  73:../../../../src/net/bmac/rf231_soc/bmac.c ****  */
  74:../../../../src/net/bmac/rf231_soc/bmac.c **** RF_RX_INFO *rf_rx_callback (RF_RX_INFO * pRRI)
  75:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 346               	.LM0:
 347               	.LFBB1:
 348               	/* prologue: function */
 349               	/* frame size = 0 */
 350               	/* stack size = 0 */
 351               	.L__stack_usage = 0
  76:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// Any code here gets called the instant a packet is received from the interrupt   
  77:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return pRRI;
  78:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 353               	.LM1:
 354 0000 0895      		ret
 356               	.Lscope1:
 358               		.stabd	78,0,0
 362               	.global	bmac_encryption_set_ctr_counter
 364               	bmac_encryption_set_ctr_counter:
 365               		.stabd	46,0,0
  79:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  80:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_ctr_counter (uint8_t * counter, uint8_t len)
  81:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 367               	.LM2:
 368               	.LFBB2:
 369               	/* prologue: function */
 370               	/* frame size = 0 */
 371               	/* stack size = 0 */
 372               	.L__stack_usage = 0
  82:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (len != 4)
 374               	.LM3:
 375 0002 6430      		cpi r22,lo8(4)
 376 0004 01F4      		brne .L4
  83:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
  84:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_security_set_ctr_counter (counter);
 378               	.LM4:
 379 0006 0E94 0000 		call rf_security_set_ctr_counter
  85:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 381               	.LM5:
 382 000a 81E0      		ldi r24,lo8(1)
 383 000c 0895      		ret
 384               	.L4:
  83:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 386               	.LM6:
 387 000e 8FEF      		ldi r24,lo8(-1)
  86:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 389               	.LM7:
 390 0010 0895      		ret
 392               	.Lscope2:
 394               		.stabd	78,0,0
 398               	.global	bmac_tx_reserve_set
 400               	bmac_tx_reserve_set:
 401               		.stabd	46,0,0
  87:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  88:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_reserve_set (nrk_time_t * period, uint16_t pkts)
  89:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 403               	.LM8:
 404               	.LFBB3:
 405               	/* prologue: function */
 406               	/* frame size = 0 */
 407               	/* stack size = 0 */
 408               	.L__stack_usage = 0
  90:../../../../src/net/bmac/rf231_soc/bmac.c **** 
  91:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
  92:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// Create a reserve if it doesn't exist
  93:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_reserve == -1)
  94:../../../../src/net/bmac/rf231_soc/bmac.c **** 		tx_reserve = nrk_reserve_create ();
  95:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_reserve >= 0)
  96:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return nrk_reserve_set (tx_reserve, period, pkts, NULL);
  97:../../../../src/net/bmac/rf231_soc/bmac.c **** 	else
  98:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
  99:../../../../src/net/bmac/rf231_soc/bmac.c **** #else
 100:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_ERROR;
 101:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 102:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 410               	.LM9:
 411 0012 8FEF      		ldi r24,lo8(-1)
 412 0014 0895      		ret
 414               	.Lscope3:
 416               		.stabd	78,0,0
 418               	.global	bmac_tx_reserve_get
 420               	bmac_tx_reserve_get:
 421               		.stabd	46,0,0
 103:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 104:../../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_tx_reserve_get ()
 105:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 423               	.LM10:
 424               	.LFBB4:
 425               	/* prologue: function */
 426               	/* frame size = 0 */
 427               	/* stack size = 0 */
 428               	.L__stack_usage = 0
 106:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 107:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_reserve >= 0)
 108:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return nrk_reserve_get (tx_reserve);
 109:../../../../src/net/bmac/rf231_soc/bmac.c **** 	else
 110:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return 0;
 111:../../../../src/net/bmac/rf231_soc/bmac.c **** #else
 112:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return 0;
 113:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 114:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 430               	.LM11:
 431 0016 80E0      		ldi r24,0
 432 0018 90E0      		ldi r25,0
 433 001a 0895      		ret
 435               	.Lscope4:
 437               		.stabd	78,0,0
 439               	.global	bmac_auto_ack_disable
 441               	bmac_auto_ack_disable:
 442               		.stabd	46,0,0
 115:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 116:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 117:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_disable ()
 118:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 444               	.LM12:
 445               	.LFBB5:
 446               	/* prologue: function */
 447               	/* frame size = 0 */
 448               	/* stack size = 0 */
 449               	.L__stack_usage = 0
 119:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_auto_ack_disable ();
 451               	.LM13:
 452 001c 0E94 0000 		call rf_auto_ack_disable
 120:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 121:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 454               	.LM14:
 455 0020 81E0      		ldi r24,lo8(1)
 456 0022 0895      		ret
 458               	.Lscope5:
 460               		.stabd	78,0,0
 462               	.global	bmac_auto_ack_enable
 464               	bmac_auto_ack_enable:
 465               		.stabd	46,0,0
 122:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 123:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_enable ()
 124:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 467               	.LM15:
 468               	.LFBB6:
 469               	/* prologue: function */
 470               	/* frame size = 0 */
 471               	/* stack size = 0 */
 472               	.L__stack_usage = 0
 125:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_auto_ack_enable ();
 474               	.LM16:
 475 0024 0E94 0000 		call rf_auto_ack_enable
 126:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 127:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 477               	.LM17:
 478 0028 81E0      		ldi r24,lo8(1)
 479 002a 0895      		ret
 481               	.Lscope6:
 483               		.stabd	78,0,0
 485               	.global	bmac_addr_decode_disable
 487               	bmac_addr_decode_disable:
 488               		.stabd	46,0,0
 128:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 129:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_disable ()
 130:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 490               	.LM18:
 491               	.LFBB7:
 492               	/* prologue: function */
 493               	/* frame size = 0 */
 494               	/* stack size = 0 */
 495               	.L__stack_usage = 0
 131:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_addr_decode_disable ();
 497               	.LM19:
 498 002c 0E94 0000 		call rf_addr_decode_disable
 132:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 133:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 500               	.LM20:
 501 0030 81E0      		ldi r24,lo8(1)
 502 0032 0895      		ret
 504               	.Lscope7:
 506               		.stabd	78,0,0
 508               	.global	bmac_addr_decode_enable
 510               	bmac_addr_decode_enable:
 511               		.stabd	46,0,0
 134:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 135:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_enable ()
 136:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 513               	.LM21:
 514               	.LFBB8:
 515               	/* prologue: function */
 516               	/* frame size = 0 */
 517               	/* stack size = 0 */
 518               	.L__stack_usage = 0
 137:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_addr_decode_enable ();
 520               	.LM22:
 521 0034 0E94 0000 		call rf_addr_decode_enable
 138:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 139:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 523               	.LM23:
 524 0038 81E0      		ldi r24,lo8(1)
 525 003a 0895      		ret
 527               	.Lscope8:
 529               		.stabd	78,0,0
 532               	.global	bmac_addr_decode_set_my_mac
 534               	bmac_addr_decode_set_my_mac:
 535               		.stabd	46,0,0
 140:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 141:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_set_my_mac (uint16_t my_mac)
 142:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 537               	.LM24:
 538               	.LFBB9:
 539               	/* prologue: function */
 540               	/* frame size = 0 */
 541               	/* stack size = 0 */
 542               	.L__stack_usage = 0
 143:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_addr_decode_set_my_mac (my_mac);
 544               	.LM25:
 545 003c 0E94 0000 		call rf_addr_decode_set_my_mac
 144:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 145:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 547               	.LM26:
 548 0040 81E0      		ldi r24,lo8(1)
 549 0042 0895      		ret
 551               	.Lscope9:
 553               		.stabd	78,0,0
 556               	.global	bmac_addr_decode_dest_mac
 558               	bmac_addr_decode_dest_mac:
 559               		.stabd	46,0,0
 146:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 147:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_dest_mac (uint16_t dest)
 148:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 561               	.LM27:
 562               	.LFBB10:
 563               	/* prologue: function */
 564               	/* frame size = 0 */
 565               	/* stack size = 0 */
 566               	.L__stack_usage = 0
 149:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.destAddr = dest;
 568               	.LM28:
 569 0044 9093 0000 		sts bmac_rfTxInfo+1,r25
 570 0048 8093 0000 		sts bmac_rfTxInfo,r24
 150:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 151:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 572               	.LM29:
 573 004c 81E0      		ldi r24,lo8(1)
 574 004e 0895      		ret
 576               	.Lscope10:
 578               		.stabd	78,0,0
 580               	.global	bmac_rx_pkt_is_encrypted
 582               	bmac_rx_pkt_is_encrypted:
 583               		.stabd	46,0,0
 152:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 153:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_is_encrypted ()
 154:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 585               	.LM30:
 586               	.LFBB11:
 587               	/* prologue: function */
 588               	/* frame size = 0 */
 589               	/* stack size = 0 */
 590               	.L__stack_usage = 0
 155:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return rf_security_last_pkt_status ();
 592               	.LM31:
 593 0050 0E94 0000 		call rf_security_last_pkt_status
 156:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 595               	.LM32:
 596 0054 0895      		ret
 598               	.Lscope11:
 600               		.stabd	78,0,0
 604               	.global	bmac_encryption_set_key
 606               	bmac_encryption_set_key:
 607               		.stabd	46,0,0
 157:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 158:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_key (uint8_t * key, uint8_t len)
 159:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 609               	.LM33:
 610               	.LFBB12:
 611               	/* prologue: function */
 612               	/* frame size = 0 */
 613               	/* stack size = 0 */
 614               	.L__stack_usage = 0
 160:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (len != 16)
 616               	.LM34:
 617 0056 6031      		cpi r22,lo8(16)
 618 0058 01F4      		brne .L17
 161:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 162:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_security_set_key (key);
 620               	.LM35:
 621 005a 0E94 0000 		call rf_security_set_key
 163:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 623               	.LM36:
 624 005e 81E0      		ldi r24,lo8(1)
 625 0060 0895      		ret
 626               	.L17:
 161:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 628               	.LM37:
 629 0062 8FEF      		ldi r24,lo8(-1)
 164:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 631               	.LM38:
 632 0064 0895      		ret
 634               	.Lscope12:
 636               		.stabd	78,0,0
 638               	.global	bmac_encryption_enable
 640               	bmac_encryption_enable:
 641               		.stabd	46,0,0
 165:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 166:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_enable ()
 167:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 643               	.LM39:
 644               	.LFBB13:
 645               	/* prologue: function */
 646               	/* frame size = 0 */
 647               	/* stack size = 0 */
 648               	.L__stack_usage = 0
 168:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//rf_security_enable();
 169:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 170:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 650               	.LM40:
 651 0066 81E0      		ldi r24,lo8(1)
 652 0068 0895      		ret
 654               	.Lscope13:
 656               		.stabd	78,0,0
 658               	.global	bmac_encryption_disable
 660               	bmac_encryption_disable:
 661               		.stabd	46,0,0
 171:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 172:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_disable ()
 173:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 663               	.LM41:
 664               	.LFBB14:
 665               	/* prologue: function */
 666               	/* frame size = 0 */
 667               	/* stack size = 0 */
 668               	.L__stack_usage = 0
 174:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//rf_security_disable();
 175:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 176:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 670               	.LM42:
 671 006a 81E0      		ldi r24,lo8(1)
 672 006c 0895      		ret
 674               	.Lscope14:
 676               		.stabd	78,0,0
 679               	.global	bmac_set_rf_power
 681               	bmac_set_rf_power:
 682               		.stabd	46,0,0
 177:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 178:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 179:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rf_power (uint8_t power)
 180:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 684               	.LM43:
 685               	.LFBB15:
 686               	/* prologue: function */
 687               	/* frame size = 0 */
 688               	/* stack size = 0 */
 689               	.L__stack_usage = 0
 181:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (power > 31)
 691               	.LM44:
 692 006e 8032      		cpi r24,lo8(32)
 693 0070 00F4      		brsh .L22
 182:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 183:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_tx_power (power);
 695               	.LM45:
 696 0072 0E94 0000 		call rf_tx_power
 184:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 698               	.LM46:
 699 0076 81E0      		ldi r24,lo8(1)
 700 0078 0895      		ret
 701               	.L22:
 182:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 703               	.LM47:
 704 007a 8FEF      		ldi r24,lo8(-1)
 185:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 706               	.LM48:
 707 007c 0895      		ret
 709               	.Lscope15:
 711               		.stabd	78,0,0
 714               	.global	bmac_set_cca_active
 716               	bmac_set_cca_active:
 717               		.stabd	46,0,0
 186:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 187:../../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_set_cca_active (uint8_t active)
 188:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 719               	.LM49:
 720               	.LFBB16:
 721               	/* prologue: function */
 722               	/* frame size = 0 */
 723               	/* stack size = 0 */
 724               	.L__stack_usage = 0
 189:../../../../src/net/bmac/rf231_soc/bmac.c **** 	cca_active = active;
 726               	.LM50:
 727 007e 8093 0000 		sts cca_active,r24
 728 0082 0895      		ret
 730               	.Lscope16:
 732               		.stabd	78,0,0
 735               	.global	bmac_set_cca_thresh
 737               	bmac_set_cca_thresh:
 738               		.stabd	46,0,0
 190:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 191:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 192:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_cca_thresh (int8_t thresh)
 193:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 740               	.LM51:
 741               	.LFBB17:
 742               	/* prologue: function */
 743               	/* frame size = 0 */
 744               	/* stack size = 0 */
 745               	.L__stack_usage = 0
 194:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_set_cca_thresh (thresh);
 747               	.LM52:
 748 0084 9927      		clr r25
 749 0086 87FD      		sbrc r24,7
 750 0088 9095      		com r25
 751 008a 0E94 0000 		call rf_set_cca_thresh
 195:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 196:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 753               	.LM53:
 754 008e 81E0      		ldi r24,lo8(1)
 755 0090 0895      		ret
 757               	.Lscope17:
 759               		.stabd	78,0,0
 762               	.global	bmac_set_channel
 764               	bmac_set_channel:
 765               		.stabd	46,0,0
 197:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 198:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_channel (uint8_t chan)
 199:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 767               	.LM54:
 768               	.LFBB18:
 769 0092 CF93      		push r28
 770 0094 DF93      		push r29
 771 0096 1F92      		push __zero_reg__
 772 0098 CDB7      		in r28,__SP_L__
 773 009a DEB7      		in r29,__SP_H__
 774               	/* prologue: function */
 775               	/* frame size = 1 */
 776               	/* stack size = 3 */
 777               	.L__stack_usage = 3
 200:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (chan > 26)
 779               	.LM55:
 780 009c 8B31      		cpi r24,lo8(27)
 781 009e 00F4      		brsh .L27
 201:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 202:../../../../src/net/bmac/rf231_soc/bmac.c **** 	g_chan = chan;
 783               	.LM56:
 784 00a0 8093 0000 		sts g_chan,r24
 203:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_power_up ();
 786               	.LM57:
 787 00a4 8983      		std Y+1,r24
 788 00a6 0E94 0000 		call rf_power_up
 204:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_init (&bmac_rfRxInfo, chan, 0xFFFF, 0x00000);
 790               	.LM58:
 791 00aa 20E0      		ldi r18,0
 792 00ac 30E0      		ldi r19,0
 793 00ae 4FEF      		ldi r20,lo8(-1)
 794 00b0 5FEF      		ldi r21,lo8(-1)
 795 00b2 6981      		ldd r22,Y+1
 796 00b4 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 797 00b6 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 798 00b8 0E94 0000 		call rf_init
 205:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 800               	.LM59:
 801 00bc 81E0      		ldi r24,lo8(1)
 802 00be 00C0      		rjmp .L26
 803               	.L27:
 201:../../../../src/net/bmac/rf231_soc/bmac.c **** 	g_chan = chan;
 805               	.LM60:
 806 00c0 8FEF      		ldi r24,lo8(-1)
 807               	.L26:
 808               	/* epilogue start */
 206:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 810               	.LM61:
 811 00c2 0F90      		pop __tmp_reg__
 812 00c4 DF91      		pop r29
 813 00c6 CF91      		pop r28
 814 00c8 0895      		ret
 816               	.Lscope18:
 818               		.stabd	78,0,0
 820               	.global	bmac_wait_until_rx_pkt
 822               	bmac_wait_until_rx_pkt:
 823               		.stabd	46,0,0
 207:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 208:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 209:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_wait_until_rx_pkt ()
 210:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 825               	.LM62:
 826               	.LFBB19:
 827               	/* prologue: function */
 828               	/* frame size = 0 */
 829               	/* stack size = 0 */
 830               	.L__stack_usage = 0
 211:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_sig_mask_t event;
 212:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 213:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (bmac_rx_pkt_ready () == 1)
 832               	.LM63:
 833 00ca 8091 0000 		lds r24,rx_buf_empty
 834 00ce 8823      		tst r24
 835 00d0 01F0      		breq .L30
 214:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_OK;
 215:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 216:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_signal_register (bmac_rx_pkt_signal);
 837               	.LM64:
 838 00d2 8091 0000 		lds r24,bmac_rx_pkt_signal
 839 00d6 0E94 0000 		call nrk_signal_register
 217:../../../../src/net/bmac/rf231_soc/bmac.c **** 	event = nrk_event_wait (SIG (bmac_rx_pkt_signal));
 841               	.LM65:
 842 00da 81E0      		ldi r24,lo8(1)
 843 00dc 90E0      		ldi r25,0
 844 00de A0E0      		ldi r26,0
 845 00e0 B0E0      		ldi r27,0
 846 00e2 BC01      		movw r22,r24
 847 00e4 CD01      		movw r24,r26
 848 00e6 0090 0000 		lds r0,bmac_rx_pkt_signal
 849 00ea 00C0      		rjmp 2f
 850               		1:
 851 00ec 660F      		lsl r22
 852 00ee 771F      		rol r23
 853 00f0 881F      		rol r24
 854 00f2 991F      		rol r25
 855               		2:
 856 00f4 0A94      		dec r0
 857 00f6 02F4      		brpl 1b
 858 00f8 0E94 0000 		call nrk_event_wait
 218:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 219:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// Check if it was a time out instead of packet RX signal
 220:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if ((event & SIG (bmac_rx_pkt_signal)) == 0)
 860               	.LM66:
 861 00fc DC01      		movw r26,r24
 862 00fe CB01      		movw r24,r22
 863 0100 0090 0000 		lds r0,bmac_rx_pkt_signal
 864 0104 00C0      		rjmp 2f
 865               		1:
 866 0106 B695      		lsr r27
 867 0108 A795      		ror r26
 868 010a 9795      		ror r25
 869 010c 8795      		ror r24
 870               		2:
 871 010e 0A94      		dec r0
 872 0110 02F4      		brpl 1b
 873 0112 80FF      		sbrs r24,0
 874 0114 00C0      		rjmp .L31
 875               	.L30:
 214:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 877               	.LM67:
 878 0116 81E0      		ldi r24,lo8(1)
 879 0118 0895      		ret
 880               	.L31:
 221:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 882               	.LM68:
 883 011a 8FEF      		ldi r24,lo8(-1)
 222:../../../../src/net/bmac/rf231_soc/bmac.c **** 	else
 223:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_OK;
 224:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 885               	.LM69:
 886 011c 0895      		ret
 891               	.Lscope19:
 893               		.stabd	78,0,0
 897               	.global	bmac_rx_pkt_set_buffer
 899               	bmac_rx_pkt_set_buffer:
 900               		.stabd	46,0,0
 225:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 226:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_set_buffer (uint8_t * buf, uint8_t size)
 227:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 902               	.LM70:
 903               	.LFBB20:
 904               	/* prologue: function */
 905               	/* frame size = 0 */
 906               	/* stack size = 0 */
 907               	.L__stack_usage = 0
 228:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (buf == NULL)
 909               	.LM71:
 910 011e 0097      		sbiw r24,0
 911 0120 01F0      		breq .L34
 229:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 230:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfRxInfo.pPayload = buf;
 913               	.LM72:
 914 0122 9093 0000 		sts bmac_rfRxInfo+5+1,r25
 915 0126 8093 0000 		sts bmac_rfRxInfo+5,r24
 231:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfRxInfo.max_length = size;
 917               	.LM73:
 918 012a 6093 0000 		sts bmac_rfRxInfo+4,r22
 232:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rx_buf_empty = 1;
 920               	.LM74:
 921 012e 81E0      		ldi r24,lo8(1)
 922 0130 8093 0000 		sts rx_buf_empty,r24
 233:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 924               	.LM75:
 925 0134 0895      		ret
 926               	.L34:
 229:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfRxInfo.pPayload = buf;
 928               	.LM76:
 929 0136 8FEF      		ldi r24,lo8(-1)
 234:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 931               	.LM77:
 932 0138 0895      		ret
 934               	.Lscope20:
 936               		.stabd	78,0,0
 939               	.global	bmac_init
 941               	bmac_init:
 942               		.stabd	46,0,0
 235:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 236:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_init (uint8_t chan)
 237:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 944               	.LM78:
 945               	.LFBB21:
 946 013a 1F93      		push r17
 947 013c CF93      		push r28
 948 013e DF93      		push r29
 949               	/* prologue: function */
 950               	/* frame size = 0 */
 951               	/* stack size = 3 */
 952               	.L__stack_usage = 3
 953 0140 182F      		mov r17,r24
 238:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_running = 0;
 955               	.LM79:
 956 0142 1092 0000 		sts bmac_running,__zero_reg__
 239:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_reserve = -1;
 958               	.LM80:
 959 0146 8FEF      		ldi r24,lo8(-1)
 960 0148 8093 0000 		sts tx_reserve,r24
 240:../../../../src/net/bmac/rf231_soc/bmac.c **** 	cca_active = true;
 962               	.LM81:
 963 014c D1E0      		ldi r29,lo8(1)
 964 014e D093 0000 		sts cca_active,r29
 241:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rx_failure_cnt = 0;
 966               	.LM82:
 967 0152 1092 0000 		sts rx_failure_cnt,__zero_reg__
 968 0156 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 969 015a 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 970 015e 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 242:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 243:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 244:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 245:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.secs = 30;
 246:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.nano_secs = 0;
 247:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_sw_wdt_init (BMAC_SW_WDT_ID, &_bmac_check_period, NULL);
 248:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_sw_wdt_start (BMAC_SW_WDT_ID);
 249:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 250:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 251:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 252:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 253:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 254:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.secs = 0;
 972               	.LM83:
 973 0162 1092 0000 		sts _bmac_check_period,__zero_reg__
 974 0166 1092 0000 		sts _bmac_check_period+1,__zero_reg__
 975 016a 1092 0000 		sts _bmac_check_period+2,__zero_reg__
 976 016e 1092 0000 		sts _bmac_check_period+3,__zero_reg__
 255:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.nano_secs = BMAC_DEFAULT_CHECK_RATE_MS * NANOS_PER_MS;
 978               	.LM84:
 979 0172 80E0      		ldi r24,0
 980 0174 91EE      		ldi r25,lo8(-31)
 981 0176 A5EF      		ldi r26,lo8(-11)
 982 0178 B5E0      		ldi r27,lo8(5)
 983 017a 8093 0000 		sts _bmac_check_period+4,r24
 984 017e 9093 0000 		sts _bmac_check_period+4+1,r25
 985 0182 A093 0000 		sts _bmac_check_period+4+2,r26
 986 0186 B093 0000 		sts _bmac_check_period+4+3,r27
 256:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rx_pkt_signal = nrk_signal_create ();
 988               	.LM85:
 989 018a 0E94 0000 		call nrk_signal_create
 990 018e C82F      		mov r28,r24
 991 0190 8093 0000 		sts bmac_rx_pkt_signal,r24
 257:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (bmac_rx_pkt_signal == NRK_ERROR) {
 993               	.LM86:
 994 0194 8F3F      		cpi r24,lo8(-1)
 995 0196 01F4      		brne .L36
 258:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("BMAC ERROR: creating rx signal failed\r\n"));
 997               	.LM87:
 998 0198 80E0      		ldi r24,lo8(__c.3713)
 999 019a 90E0      		ldi r25,hi8(__c.3713)
 1000 019c 00C0      		rjmp .L40
 1001               	.L36:
 259:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 260:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 261:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 262:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_tx_pkt_done_signal = nrk_signal_create ();
 1003               	.LM88:
 1004 019e 0E94 0000 		call nrk_signal_create
 1005 01a2 C82F      		mov r28,r24
 1006 01a4 8093 0000 		sts bmac_tx_pkt_done_signal,r24
 263:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (bmac_tx_pkt_done_signal == NRK_ERROR) {
 1008               	.LM89:
 1009 01a8 8F3F      		cpi r24,lo8(-1)
 1010 01aa 01F4      		brne .L38
 264:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("BMAC ERROR: creating tx signal failed\r\n"));
 1012               	.LM90:
 1013 01ac 80E0      		ldi r24,lo8(__c.3715)
 1014 01ae 90E0      		ldi r25,hi8(__c.3715)
 1015               	.L40:
 1016 01b0 0E94 0000 		call nrk_kprintf
 265:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 1018               	.LM91:
 1019 01b4 E091 0000 		lds r30,nrk_cur_task_TCB
 1020 01b8 F091 0000 		lds r31,nrk_cur_task_TCB+1
 1021 01bc 6085      		ldd r22,Z+8
 1022 01be 8EE0      		ldi r24,lo8(14)
 1023 01c0 0E94 0000 		call nrk_kernel_error_add
 266:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 1025               	.LM92:
 1026 01c4 00C0      		rjmp .L37
 1027               	.L38:
 267:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 268:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_enable_signal = nrk_signal_create ();
 1029               	.LM93:
 1030 01c6 0E94 0000 		call nrk_signal_create
 1031 01ca C82F      		mov r28,r24
 1032 01cc 8093 0000 		sts bmac_enable_signal,r24
 269:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (bmac_enable_signal == NRK_ERROR) {
 1034               	.LM94:
 1035 01d0 8F3F      		cpi r24,lo8(-1)
 1036 01d2 01F4      		brne .L39
 270:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("BMAC ERROR: creating enable signal failed\r\n"));
 1038               	.LM95:
 1039 01d4 80E0      		ldi r24,lo8(__c.3717)
 1040 01d6 90E0      		ldi r25,hi8(__c.3717)
 1041 01d8 00C0      		rjmp .L40
 1042               	.L39:
 271:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 272:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 273:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 274:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 275:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 276:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 0;
 1044               	.LM96:
 1045 01da 1092 0000 		sts tx_data_ready,__zero_reg__
 277:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// Set the one main rx buffer
 278:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rx_buf_empty = 0;
 1047               	.LM97:
 1048 01de 1092 0000 		sts rx_buf_empty,__zero_reg__
 279:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfRxInfo.pPayload = NULL;
 1050               	.LM98:
 1051 01e2 1092 0000 		sts bmac_rfRxInfo+5+1,__zero_reg__
 1052 01e6 1092 0000 		sts bmac_rfRxInfo+5,__zero_reg__
 280:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfRxInfo.max_length = 0;
 1054               	.LM99:
 1055 01ea 1092 0000 		sts bmac_rfRxInfo+4,__zero_reg__
 281:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 282:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// Setup the cc2420 chip
 283:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_power_up ();
 1057               	.LM100:
 1058 01ee 0E94 0000 		call rf_power_up
 284:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_init (&bmac_rfRxInfo, chan, 0xffff, 0);
 1060               	.LM101:
 1061 01f2 20E0      		ldi r18,0
 1062 01f4 30E0      		ldi r19,0
 1063 01f6 4FEF      		ldi r20,lo8(-1)
 1064 01f8 5FEF      		ldi r21,lo8(-1)
 1065 01fa 612F      		mov r22,r17
 1066 01fc 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 1067 01fe 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 1068 0200 0E94 0000 		call rf_init
 285:../../../../src/net/bmac/rf231_soc/bmac.c **** 	g_chan = chan;
 1070               	.LM102:
 1071 0204 1093 0000 		sts g_chan,r17
 286:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 287:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//    FASTSPI_SETREG(CC2420_RSSI, 0xE580); // CCA THR=-25
 288:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//    FASTSPI_SETREG(CC2420_TXCTRL, 0x80FF); // TX TURNAROUND = 128 us
 289:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//    FASTSPI_SETREG(CC2420_RXCTRL1, 0x0A56); 
 290:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// default cca thresh of -45
 291:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//rf_set_cca_thresh(-45); 
 292:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_set_cca_thresh (0x0);
 1073               	.LM103:
 1074 0208 80E0      		ldi r24,0
 1075 020a 90E0      		ldi r25,0
 1076 020c 0E94 0000 		call rf_set_cca_thresh
 293:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_running = 1;
 1078               	.LM104:
 1079 0210 D093 0000 		sts bmac_running,r29
 294:../../../../src/net/bmac/rf231_soc/bmac.c **** 	is_enabled = 1;
 1081               	.LM105:
 1082 0214 D093 0000 		sts is_enabled,r29
 295:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 1084               	.LM106:
 1085 0218 C1E0      		ldi r28,lo8(1)
 1086               	.L37:
 296:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1088               	.LM107:
 1089 021a 8C2F      		mov r24,r28
 1090               	/* epilogue start */
 1091 021c DF91      		pop r29
 1092 021e CF91      		pop r28
 1093 0220 1F91      		pop r17
 1094 0222 0895      		ret
 1096               	.Lscope21:
 1098               		.stabd	78,0,0
 1102               	.global	bmac_tx_pkt_nonblocking
 1104               	bmac_tx_pkt_nonblocking:
 1105               		.stabd	46,0,0
 297:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 298:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt_nonblocking (uint8_t * buf, uint8_t len)
 299:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1107               	.LM108:
 1108               	.LFBB22:
 1109               	/* prologue: function */
 1110               	/* frame size = 0 */
 1111               	/* stack size = 0 */
 1112               	.L__stack_usage = 0
 300:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_data_ready == 1)
 1114               	.LM109:
 1115 0224 2091 0000 		lds r18,tx_data_ready
 1116 0228 2130      		cpi r18,lo8(1)
 1117 022a 01F0      		breq .L43
 301:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 302:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 1;
 1119               	.LM110:
 1120 022c 21E0      		ldi r18,lo8(1)
 1121 022e 2093 0000 		sts tx_data_ready,r18
 303:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.pPayload = buf;
 1123               	.LM111:
 1124 0232 9093 0000 		sts bmac_rfTxInfo+3+1,r25
 1125 0236 8093 0000 		sts bmac_rfTxInfo+3,r24
 304:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.length = len;
 1127               	.LM112:
 1128 023a 6093 0000 		sts bmac_rfTxInfo+2,r22
 305:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 1130               	.LM113:
 1131 023e 81E0      		ldi r24,lo8(1)
 1132 0240 0895      		ret
 1133               	.L43:
 301:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 1;
 1135               	.LM114:
 1136 0242 8FEF      		ldi r24,lo8(-1)
 306:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1138               	.LM115:
 1139 0244 0895      		ret
 1141               	.Lscope22:
 1143               		.stabd	78,0,0
 1145               	.global	bmac_get_rx_pkt_signal
 1147               	bmac_get_rx_pkt_signal:
 1148               		.stabd	46,0,0
 307:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 308:../../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_rx_pkt_signal ()
 309:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1150               	.LM116:
 1151               	.LFBB23:
 1152               	/* prologue: function */
 1153               	/* frame size = 0 */
 1154               	/* stack size = 0 */
 1155               	.L__stack_usage = 0
 310:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_signal_register (bmac_rx_pkt_signal);
 1157               	.LM117:
 1158 0246 8091 0000 		lds r24,bmac_rx_pkt_signal
 1159 024a 0E94 0000 		call nrk_signal_register
 311:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return (bmac_rx_pkt_signal);
 312:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1161               	.LM118:
 1162 024e 8091 0000 		lds r24,bmac_rx_pkt_signal
 1163 0252 0895      		ret
 1165               	.Lscope23:
 1167               		.stabd	78,0,0
 1169               	.global	bmac_get_tx_done_signal
 1171               	bmac_get_tx_done_signal:
 1172               		.stabd	46,0,0
 313:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 314:../../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_tx_done_signal ()
 315:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1174               	.LM119:
 1175               	.LFBB24:
 1176               	/* prologue: function */
 1177               	/* frame size = 0 */
 1178               	/* stack size = 0 */
 1179               	.L__stack_usage = 0
 316:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_signal_register (bmac_tx_pkt_done_signal);
 1181               	.LM120:
 1182 0254 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1183 0258 0E94 0000 		call nrk_signal_register
 317:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return (bmac_tx_pkt_done_signal);
 318:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1185               	.LM121:
 1186 025c 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1187 0260 0895      		ret
 1189               	.Lscope24:
 1191               		.stabd	78,0,0
 1195               	.global	bmac_tx_pkt
 1197               	bmac_tx_pkt:
 1198               		.stabd	46,0,0
 319:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 320:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 321:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt (uint8_t * buf, uint8_t len)
 322:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1200               	.LM122:
 1201               	.LFBB25:
 1202 0262 CF92      		push r12
 1203 0264 DF92      		push r13
 1204 0266 EF92      		push r14
 1205 0268 FF92      		push r15
 1206               	/* prologue: function */
 1207               	/* frame size = 0 */
 1208               	/* stack size = 4 */
 1209               	.L__stack_usage = 4
 323:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint32_t mask;
 324:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_data_ready == 1)
 1211               	.LM123:
 1212 026a 2091 0000 		lds r18,tx_data_ready
 1213 026e 2130      		cpi r18,lo8(1)
 1214 0270 01F0      		breq .L50
 1215 0272 F62E      		mov r15,r22
 1216 0274 6C01      		movw r12,r24
 325:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 326:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// If reserve exists check it
 327:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 328:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (tx_reserve != -1) {
 329:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if (nrk_reserve_consume (tx_reserve) == NRK_ERROR) {
 330:../../../../src/net/bmac/rf231_soc/bmac.c **** 			return NRK_ERROR;
 331:../../../../src/net/bmac/rf231_soc/bmac.c **** 		}
 332:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 333:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 334:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_signal_register (bmac_tx_pkt_done_signal);
 1218               	.LM124:
 1219 0276 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1220 027a 0E94 0000 		call nrk_signal_register
 335:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 1;
 1222               	.LM125:
 1223 027e 81E0      		ldi r24,lo8(1)
 1224 0280 8093 0000 		sts tx_data_ready,r24
 336:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.pPayload = buf;
 1226               	.LM126:
 1227 0284 D092 0000 		sts bmac_rfTxInfo+3+1,r13
 1228 0288 C092 0000 		sts bmac_rfTxInfo+3,r12
 337:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.length = len;
 1230               	.LM127:
 1231 028c F092 0000 		sts bmac_rfTxInfo+2,r15
 338:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 339:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_kprintf (PSTR ("Waiting for tx done signal\r\n"));
 340:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 341:../../../../src/net/bmac/rf231_soc/bmac.c **** 	mask = nrk_event_wait (SIG (bmac_tx_pkt_done_signal));
 1233               	.LM128:
 1234 0290 81E0      		ldi r24,lo8(1)
 1235 0292 90E0      		ldi r25,0
 1236 0294 A0E0      		ldi r26,0
 1237 0296 B0E0      		ldi r27,0
 1238 0298 BC01      		movw r22,r24
 1239 029a CD01      		movw r24,r26
 1240 029c 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1241 02a0 00C0      		rjmp 2f
 1242               		1:
 1243 02a2 660F      		lsl r22
 1244 02a4 771F      		rol r23
 1245 02a6 881F      		rol r24
 1246 02a8 991F      		rol r25
 1247               		2:
 1248 02aa 0A94      		dec r0
 1249 02ac 02F4      		brpl 1b
 1250 02ae 0E94 0000 		call nrk_event_wait
 1251 02b2 6B01      		movw r12,r22
 1252 02b4 7C01      		movw r14,r24
 342:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (mask == 0)
 1254               	.LM129:
 1255 02b6 6115      		cp r22,__zero_reg__
 1256 02b8 7105      		cpc r23,__zero_reg__
 1257 02ba 8105      		cpc r24,__zero_reg__
 1258 02bc 9105      		cpc r25,__zero_reg__
 1259 02be 01F4      		brne .L48
 343:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("BMAC TX: Error calling event wait\r\n"));
 1261               	.LM130:
 1262 02c0 80E0      		ldi r24,lo8(__c.3733)
 1263 02c2 90E0      		ldi r25,hi8(__c.3733)
 1264 02c4 0E94 0000 		call nrk_kprintf
 1265               	.L48:
 344:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if ((mask & SIG (bmac_tx_pkt_done_signal)) == 0)
 1267               	.LM131:
 1268 02c8 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1269 02cc 00C0      		rjmp 2f
 1270               		1:
 1271 02ce F694      		lsr r15
 1272 02d0 E794      		ror r14
 1273 02d2 D794      		ror r13
 1274 02d4 C794      		ror r12
 1275               		2:
 1276 02d6 0A94      		dec r0
 1277 02d8 02F4      		brpl 1b
 1278 02da C0FC      		sbrc r12,0
 1279 02dc 00C0      		rjmp .L49
 345:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("BMAC TX: Woke up on wrong signal\r\n"));
 1281               	.LM132:
 1282 02de 80E0      		ldi r24,lo8(__c.3735)
 1283 02e0 90E0      		ldi r25,hi8(__c.3735)
 1284 02e2 0E94 0000 		call nrk_kprintf
 1285               	.L49:
 346:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (pkt_got_ack)
 1287               	.LM133:
 1288 02e6 8091 0000 		lds r24,pkt_got_ack
 1289 02ea 8111      		cpse r24,__zero_reg__
 1290 02ec 00C0      		rjmp .L51
 1291               	.L50:
 325:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// If reserve exists check it
 1293               	.LM134:
 1294 02ee 8FEF      		ldi r24,lo8(-1)
 1295 02f0 00C0      		rjmp .L47
 1296               	.L51:
 347:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_OK;
 1298               	.LM135:
 1299 02f2 81E0      		ldi r24,lo8(1)
 1300               	.L47:
 1301               	/* epilogue start */
 348:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_ERROR;
 349:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1303               	.LM136:
 1304 02f4 FF90      		pop r15
 1305 02f6 EF90      		pop r14
 1306 02f8 DF90      		pop r13
 1307 02fa CF90      		pop r12
 1308 02fc 0895      		ret
 1313               	.Lscope25:
 1315               		.stabd	78,0,0
 1319               	.global	bmac_rx_pkt_get
 1321               	bmac_rx_pkt_get:
 1322               		.stabd	46,0,0
 350:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 351:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 352:../../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t *bmac_rx_pkt_get (uint8_t * len, int8_t * rssi)
 353:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1324               	.LM137:
 1325               	.LFBB26:
 1326               	/* prologue: function */
 1327               	/* frame size = 0 */
 1328               	/* stack size = 0 */
 1329               	.L__stack_usage = 0
 354:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 355:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (bmac_rx_pkt_ready () == 0) {
 1331               	.LM138:
 1332 02fe 2091 0000 		lds r18,rx_buf_empty
 1333 0302 2223      		tst r18
 1334 0304 01F0      		breq .L53
 356:../../../../src/net/bmac/rf231_soc/bmac.c **** 		*len = 0;
 1336               	.LM139:
 1337 0306 FC01      		movw r30,r24
 1338 0308 1082      		st Z,__zero_reg__
 357:../../../../src/net/bmac/rf231_soc/bmac.c **** 		*rssi = 0;
 1340               	.LM140:
 1341 030a FB01      		movw r30,r22
 1342 030c 1082      		st Z,__zero_reg__
 358:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NULL;
 1344               	.LM141:
 1345 030e 80E0      		ldi r24,0
 1346 0310 90E0      		ldi r25,0
 1347 0312 0895      		ret
 1348               	.L53:
 359:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 360:../../../../src/net/bmac/rf231_soc/bmac.c **** 	*len = bmac_rfRxInfo.length;
 1350               	.LM142:
 1351 0314 2091 0000 		lds r18,bmac_rfRxInfo+3
 1352 0318 FC01      		movw r30,r24
 1353 031a 2083      		st Z,r18
 361:../../../../src/net/bmac/rf231_soc/bmac.c **** 	*rssi = bmac_rfRxInfo.rssi;
 1355               	.LM143:
 1356 031c 8091 0000 		lds r24,bmac_rfRxInfo+8
 1357 0320 FB01      		movw r30,r22
 1358 0322 8083      		st Z,r24
 362:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return bmac_rfRxInfo.pPayload;
 1360               	.LM144:
 1361 0324 8091 0000 		lds r24,bmac_rfRxInfo+5
 1362 0328 9091 0000 		lds r25,bmac_rfRxInfo+5+1
 363:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1364               	.LM145:
 1365 032c 0895      		ret
 1367               	.Lscope26:
 1369               		.stabd	78,0,0
 1371               	.global	bmac_rx_pkt_ready
 1373               	bmac_rx_pkt_ready:
 1374               		.stabd	46,0,0
 364:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 365:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_ready (void)
 366:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1376               	.LM146:
 1377               	.LFBB27:
 1378               	/* prologue: function */
 1379               	/* frame size = 0 */
 1380               	/* stack size = 0 */
 1381               	.L__stack_usage = 0
 367:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return (!rx_buf_empty);
 1383               	.LM147:
 1384 032e 81E0      		ldi r24,lo8(1)
 1385 0330 9091 0000 		lds r25,rx_buf_empty
 1386 0334 9111      		cpse r25,__zero_reg__
 1387 0336 80E0      		ldi r24,0
 1388               	.L56:
 368:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1390               	.LM148:
 1391 0338 0895      		ret
 1393               	.Lscope27:
 1395               		.stabd	78,0,0
 1397               	.global	bmac_rx_pkt_release
 1399               	bmac_rx_pkt_release:
 1400               		.stabd	46,0,0
 369:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 370:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_release (void)
 371:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1402               	.LM149:
 1403               	.LFBB28:
 1404               	/* prologue: function */
 1405               	/* frame size = 0 */
 1406               	/* stack size = 0 */
 1407               	.L__stack_usage = 0
 372:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rx_buf_empty = 1;
 1409               	.LM150:
 1410 033a 81E0      		ldi r24,lo8(1)
 1411 033c 8093 0000 		sts rx_buf_empty,r24
 373:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 374:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1413               	.LM151:
 1414 0340 0895      		ret
 1416               	.Lscope28:
 1418               		.stabd	78,0,0
 1420               	.global	bmac_disable
 1422               	bmac_disable:
 1423               		.stabd	46,0,0
 375:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 376:../../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_disable ()
 377:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1425               	.LM152:
 1426               	.LFBB29:
 1427               	/* prologue: function */
 1428               	/* frame size = 0 */
 1429               	/* stack size = 0 */
 1430               	.L__stack_usage = 0
 378:../../../../src/net/bmac/rf231_soc/bmac.c **** 	is_enabled = 0;
 1432               	.LM153:
 1433 0342 1092 0000 		sts is_enabled,__zero_reg__
 379:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_power_down ();
 1435               	.LM154:
 1436 0346 0C94 0000 		jmp rf_power_down
 1438               	.Lscope29:
 1440               		.stabd	78,0,0
 1442               	.global	bmac_enable
 1444               	bmac_enable:
 1445               		.stabd	46,0,0
 380:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 381:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 382:../../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_enable ()
 383:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1447               	.LM155:
 1448               	.LFBB30:
 1449               	/* prologue: function */
 1450               	/* frame size = 0 */
 1451               	/* stack size = 0 */
 1452               	.L__stack_usage = 0
 384:../../../../src/net/bmac/rf231_soc/bmac.c **** 	is_enabled = 1;
 1454               	.LM156:
 1455 034a 81E0      		ldi r24,lo8(1)
 1456 034c 8093 0000 		sts is_enabled,r24
 385:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_power_up ();
 1458               	.LM157:
 1459 0350 0E94 0000 		call rf_power_up
 386:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_event_signal (bmac_enable_signal);
 1461               	.LM158:
 1462 0354 8091 0000 		lds r24,bmac_enable_signal
 1463 0358 0C94 0000 		jmp nrk_event_signal
 1465               	.Lscope30:
 1467               		.stabd	78,0,0
 1470               	.global	bmac_set_rx_check_rate
 1472               	bmac_set_rx_check_rate:
 1473               		.stabd	46,0,0
 387:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 388:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 389:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 390:../../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_nw_task ()
 391:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 392:../../../../src/net/bmac/rf231_soc/bmac.c **** 	int8_t v, i;
 393:../../../../src/net/bmac/rf231_soc/bmac.c **** 	int8_t e;
 394:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t backoff;
 395:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_sig_mask_t event;
 396:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 397:../../../../src/net/bmac/rf231_soc/bmac.c **** 	while (bmac_started () == 0)
 398:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_wait_until_next_period ();
 399:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 400:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//register the signal after bmac_init has been called
 401:../../../../src/net/bmac/rf231_soc/bmac.c **** 	v = nrk_signal_register (bmac_enable_signal);
 402:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (v == NRK_ERROR)
 403:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 404:../../../../src/net/bmac/rf231_soc/bmac.c **** 	backoff = 0;
 405:../../../../src/net/bmac/rf231_soc/bmac.c **** 	while (1) {
 406:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 407:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 408:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_sw_wdt_update (BMAC_SW_WDT_ID);
 409:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 410:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 411:../../../../src/net/bmac/rf231_soc/bmac.c **** 		rf_power_up ();
 412:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if (is_enabled) {
 413:../../../../src/net/bmac/rf231_soc/bmac.c **** 			v = 1;
 414:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 415:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 416:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (rx_buf_empty == 1)
 417:../../../../src/net/bmac/rf231_soc/bmac.c **** 			{
 418:../../../../src/net/bmac/rf231_soc/bmac.c **** 				if (_bmac_rx () == 1) e = nrk_event_signal (bmac_rx_pkt_signal);
 419:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 420:../../../../src/net/bmac/rf231_soc/bmac.c **** 			else
 421:../../../../src/net/bmac/rf231_soc/bmac.c **** 				e = nrk_event_signal (bmac_rx_pkt_signal);
 422:../../../../src/net/bmac/rf231_soc/bmac.c **** #else
 423:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (rx_buf_empty == 1)
 424:../../../../src/net/bmac/rf231_soc/bmac.c **** 				v = _bmac_channel_check ();
 425:../../../../src/net/bmac/rf231_soc/bmac.c **** 			// If the buffer is full, signal the receiving task again.
 426:../../../../src/net/bmac/rf231_soc/bmac.c **** 			else
 427:../../../../src/net/bmac/rf231_soc/bmac.c **** 				e = nrk_event_signal (bmac_rx_pkt_signal);
 428:../../../../src/net/bmac/rf231_soc/bmac.c **** 			// bmac_channel check turns on radio, don't turn off if
 429:../../../../src/net/bmac/rf231_soc/bmac.c **** 			// data is coming.
 430:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 431:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (v == 0) {
 432:../../../../src/net/bmac/rf231_soc/bmac.c **** 				if (_bmac_rx () == 1) {
 433:../../../../src/net/bmac/rf231_soc/bmac.c **** 					e = nrk_event_signal (bmac_rx_pkt_signal);
 434:../../../../src/net/bmac/rf231_soc/bmac.c **** 					//if(e==NRK_ERROR) {
 435:../../../../src/net/bmac/rf231_soc/bmac.c **** 					//      nrk_kprintf( PSTR("bmac rx pkt signal failed\r\n"));
 436:../../../../src/net/bmac/rf231_soc/bmac.c **** 					//      printf( "errno: %u \r\n",nrk_errno_get() );
 437:../../../../src/net/bmac/rf231_soc/bmac.c **** 					//}
 438:../../../../src/net/bmac/rf231_soc/bmac.c **** 				}
 439:../../../../src/net/bmac/rf231_soc/bmac.c **** 				//else nrk_kprintf( PSTR("Pkt failed, buf could be corrupt\r\n" ));
 440:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 441:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 442:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 443:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 444:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (tx_data_ready == 1) {
 445:../../../../src/net/bmac/rf231_soc/bmac.c **** 				_bmac_tx ();
 446:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 447:../../../../src/net/bmac/rf231_soc/bmac.c **** 			rf_rx_off ();
 448:../../../../src/net/bmac/rf231_soc/bmac.c **** 			rf_power_down ();
 449:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 450:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//do {
 451:../../../../src/net/bmac/rf231_soc/bmac.c **** 			nrk_wait (_bmac_check_period);
 452:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      if(rx_buf_empty!=1)  nrk_event_signal (bmac_rx_pkt_signal);
 453:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//} while(rx_buf_empty!=1);
 454:../../../../src/net/bmac/rf231_soc/bmac.c **** 		}
 455:../../../../src/net/bmac/rf231_soc/bmac.c **** 		else {
 456:../../../../src/net/bmac/rf231_soc/bmac.c **** 			event = 0;
 457:../../../../src/net/bmac/rf231_soc/bmac.c **** 			do {
 458:../../../../src/net/bmac/rf231_soc/bmac.c **** 				v = nrk_signal_register (bmac_enable_signal);
 459:../../../../src/net/bmac/rf231_soc/bmac.c **** 				event = nrk_event_wait (SIG (bmac_enable_signal));
 460:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 461:../../../../src/net/bmac/rf231_soc/bmac.c **** 			while ((event & SIG (bmac_enable_signal)) == 0);
 462:../../../../src/net/bmac/rf231_soc/bmac.c **** 		}
 463:../../../../src/net/bmac/rf231_soc/bmac.c **** 		//nrk_wait_until_next_period();
 464:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 465:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 466:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 467:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 468:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 469:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rx_check_rate (nrk_time_t period)
 470:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1475               	.LM159:
 1476               	.LFBB31:
 1477 035c CF93      		push r28
 1478 035e DF93      		push r29
 1479 0360 CDB7      		in r28,__SP_L__
 1480 0362 DEB7      		in r29,__SP_H__
 1481 0364 2897      		sbiw r28,8
 1482 0366 0FB6      		in __tmp_reg__,__SREG__
 1483 0368 F894      		cli
 1484 036a DEBF      		out __SP_H__,r29
 1485 036c 0FBE      		out __SREG__,__tmp_reg__
 1486 036e CDBF      		out __SP_L__,r28
 1487               	/* prologue: function */
 1488               	/* frame size = 8 */
 1489               	/* stack size = 10 */
 1490               	.L__stack_usage = 10
 1491 0370 2983      		std Y+1,r18
 1492 0372 3A83      		std Y+2,r19
 1493 0374 4B83      		std Y+3,r20
 1494 0376 5C83      		std Y+4,r21
 1495 0378 6D83      		std Y+5,r22
 1496 037a 7E83      		std Y+6,r23
 1497 037c 8F83      		std Y+7,r24
 1498 037e 9887      		std Y+8,r25
 1499 0380 4981      		ldd r20,Y+1
 1500 0382 5A81      		ldd r21,Y+2
 1501 0384 6B81      		ldd r22,Y+3
 1502 0386 7C81      		ldd r23,Y+4
 1503 0388 8D81      		ldd r24,Y+5
 1504 038a 9E81      		ldd r25,Y+6
 1505 038c AF81      		ldd r26,Y+7
 1506 038e B885      		ldd r27,Y+8
 471:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (period.secs == 0
 1508               	.LM160:
 1509 0390 4115      		cp r20,__zero_reg__
 1510 0392 5105      		cpc r21,__zero_reg__
 1511 0394 6105      		cpc r22,__zero_reg__
 1512 0396 7105      		cpc r23,__zero_reg__
 1513 0398 01F4      		brne .L64
 472:../../../../src/net/bmac/rf231_soc/bmac.c **** 			&& period.nano_secs < BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS)
 1515               	.LM161:
 1516 039a 8115      		cp r24,__zero_reg__
 1517 039c 2DE2      		ldi r18,45
 1518 039e 9207      		cpc r25,r18
 1519 03a0 21E3      		ldi r18,49
 1520 03a2 A207      		cpc r26,r18
 1521 03a4 21E0      		ldi r18,1
 1522 03a6 B207      		cpc r27,r18
 1523 03a8 00F0      		brlo .L66
 1524               	.L64:
 473:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 474:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.secs = period.secs;
 1526               	.LM162:
 1527 03aa 4093 0000 		sts _bmac_check_period,r20
 1528 03ae 5093 0000 		sts _bmac_check_period+1,r21
 1529 03b2 6093 0000 		sts _bmac_check_period+2,r22
 1530 03b6 7093 0000 		sts _bmac_check_period+3,r23
 475:../../../../src/net/bmac/rf231_soc/bmac.c **** 	_bmac_check_period.nano_secs = period.nano_secs;
 1532               	.LM163:
 1533 03ba 8093 0000 		sts _bmac_check_period+4,r24
 1534 03be 9093 0000 		sts _bmac_check_period+4+1,r25
 1535 03c2 A093 0000 		sts _bmac_check_period+4+2,r26
 1536 03c6 B093 0000 		sts _bmac_check_period+4+3,r27
 476:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 1538               	.LM164:
 1539 03ca 81E0      		ldi r24,lo8(1)
 1540 03cc 00C0      		rjmp .L65
 1541               	.L66:
 473:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return NRK_ERROR;
 1543               	.LM165:
 1544 03ce 8FEF      		ldi r24,lo8(-1)
 1545               	.L65:
 1546               	/* epilogue start */
 477:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1548               	.LM166:
 1549 03d0 2896      		adiw r28,8
 1550 03d2 0FB6      		in __tmp_reg__,__SREG__
 1551 03d4 F894      		cli
 1552 03d6 DEBF      		out __SP_H__,r29
 1553 03d8 0FBE      		out __SREG__,__tmp_reg__
 1554 03da CDBF      		out __SP_L__,r28
 1555 03dc DF91      		pop r29
 1556 03de CF91      		pop r28
 1557 03e0 0895      		ret
 1559               	.Lscope31:
 1561               		.stabd	78,0,0
 1563               	.global	bmac_started
 1565               	bmac_started:
 1566               		.stabd	46,0,0
 478:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 479:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_started ()
 480:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1568               	.LM167:
 1569               	.LFBB32:
 1570               	/* prologue: function */
 1571               	/* frame size = 0 */
 1572               	/* stack size = 0 */
 1573               	.L__stack_usage = 0
 481:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return bmac_running;
 482:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1575               	.LM168:
 1576 03e2 8091 0000 		lds r24,bmac_running
 1577 03e6 0895      		ret
 1579               	.Lscope32:
 1581               		.stabd	78,0,0
 1583               	.global	_bmac_channel_check
 1585               	_bmac_channel_check:
 1586               		.stabd	46,0,0
 483:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 484:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_channel_check ()
 485:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1588               	.LM169:
 1589               	.LFBB33:
 1590 03e8 CF93      		push r28
 1591               	/* prologue: function */
 1592               	/* frame size = 0 */
 1593               	/* stack size = 1 */
 1594               	.L__stack_usage = 1
 486:../../../../src/net/bmac/rf231_soc/bmac.c **** 	int8_t val = 0;
 487:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 488:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_rx_on ();
 1596               	.LM170:
 1597 03ea 0E94 0000 		call rf_rx_on
 489:../../../../src/net/bmac/rf231_soc/bmac.c **** 	val += rf_cca_check ();
 1599               	.LM171:
 1600 03ee 0E94 0000 		call rf_cca_check
 1601 03f2 C82F      		mov r28,r24
 490:../../../../src/net/bmac/rf231_soc/bmac.c **** 	val += rf_cca_check ();
 1603               	.LM172:
 1604 03f4 0E94 0000 		call rf_cca_check
 1605 03f8 C80F      		add r28,r24
 491:../../../../src/net/bmac/rf231_soc/bmac.c **** 	val += rf_cca_check ();
 1607               	.LM173:
 1608 03fa 0E94 0000 		call rf_cca_check
 1609 03fe C80F      		add r28,r24
 492:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (val > 1)
 493:../../../../src/net/bmac/rf231_soc/bmac.c **** 		val = 1;
 494:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_rx_off ();
 1611               	.LM174:
 1612 0400 0E94 0000 		call rf_rx_off
 1613 0404 8C2F      		mov r24,r28
 1614 0406 1C16      		cp __zero_reg__,r28
 1615 0408 04F4      		brge .L69
 1616 040a 81E0      		ldi r24,lo8(1)
 1617               	.L69:
 1618               	/* epilogue start */
 495:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return val;
 496:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1620               	.LM175:
 1621 040c CF91      		pop r28
 1622 040e 0895      		ret
 1624               	.Lscope33:
 1626               		.stabd	78,0,0
 1628               	.global	_bmac_rx
 1630               	_bmac_rx:
 1631               		.stabd	46,0,0
 497:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 498:../../../../src/net/bmac/rf231_soc/bmac.c **** // Assuming that CCA returned 1 and a packet is on its way
 499:../../../../src/net/bmac/rf231_soc/bmac.c **** // Receive the packet or timeout and error
 500:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_rx ()
 501:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1633               	.LM176:
 1634               	.LFBB34:
 1635               	/* prologue: function */
 1636               	/* frame size = 0 */
 1637               	/* stack size = 0 */
 1638               	.L__stack_usage = 0
 502:../../../../src/net/bmac/rf231_soc/bmac.c **** 	int8_t n;
 503:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t cnt;
 504:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 505:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_rx_on ();
 1640               	.LM177:
 1641 0410 0E94 0000 		call rf_rx_on
 506:../../../../src/net/bmac/rf231_soc/bmac.c **** 	cnt = 0;
 507:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//printf( "calling rx\r\n" );
 508:../../../../src/net/bmac/rf231_soc/bmac.c **** 	dummy_t.secs = 0;
 1643               	.LM178:
 1644 0414 1092 0000 		sts dummy_t,__zero_reg__
 1645 0418 1092 0000 		sts dummy_t+1,__zero_reg__
 1646 041c 1092 0000 		sts dummy_t+2,__zero_reg__
 1647 0420 1092 0000 		sts dummy_t+3,__zero_reg__
 509:../../../../src/net/bmac/rf231_soc/bmac.c **** 	dummy_t.nano_secs = 5 * NANOS_PER_MS;
 1649               	.LM179:
 1650 0424 80E4      		ldi r24,lo8(64)
 1651 0426 682F      		mov r22,r24
 1652 0428 8093 0000 		sts dummy_t+4,r24
 1653 042c 8BE4      		ldi r24,lo8(75)
 1654 042e 8093 0000 		sts dummy_t+5,r24
 1655 0432 8CE4      		ldi r24,lo8(76)
 1656 0434 8093 0000 		sts dummy_t+6,r24
 1657 0438 1092 0000 		sts dummy_t+7,__zero_reg__
 510:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_wait (dummy_t);
 1659               	.LM180:
 1660 043c 20E0      		ldi r18,0
 1661 043e 3091 0000 		lds r19,dummy_t+1
 1662 0442 4091 0000 		lds r20,dummy_t+2
 1663 0446 5091 0000 		lds r21,dummy_t+3
 1664 044a 7BE4      		ldi r23,lo8(75)
 1665 044c 90E0      		ldi r25,0
 1666 044e 0E94 0000 		call nrk_wait
 511:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 512:../../../../src/net/bmac/rf231_soc/bmac.c **** 	n = rf_rx_packet_nonblock ();
 1668               	.LM181:
 1669 0452 0E94 0000 		call rf_rx_packet_nonblock
 513:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 514:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (n != NRK_OK) {
 1671               	.LM182:
 1672 0456 8130      		cpi r24,lo8(1)
 1673 0458 01F0      		breq .L71
 515:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if (rx_failure_cnt < 65535)
 1675               	.LM183:
 1676 045a 8091 0000 		lds r24,rx_failure_cnt
 1677 045e 9091 0000 		lds r25,rx_failure_cnt+1
 1678 0462 A091 0000 		lds r26,rx_failure_cnt+2
 1679 0466 B091 0000 		lds r27,rx_failure_cnt+3
 1680 046a 8F3F      		cpi r24,-1
 1681 046c 2FEF      		ldi r18,-1
 1682 046e 9207      		cpc r25,r18
 1683 0470 A105      		cpc r26,__zero_reg__
 1684 0472 B105      		cpc r27,__zero_reg__
 1685 0474 00F4      		brsh .L72
 516:../../../../src/net/bmac/rf231_soc/bmac.c **** 			rx_failure_cnt++;
 1687               	.LM184:
 1688 0476 0196      		adiw r24,1
 1689 0478 A11D      		adc r26,__zero_reg__
 1690 047a B11D      		adc r27,__zero_reg__
 1691 047c 8093 0000 		sts rx_failure_cnt,r24
 1692 0480 9093 0000 		sts rx_failure_cnt+1,r25
 1693 0484 A093 0000 		sts rx_failure_cnt+2,r26
 1694 0488 B093 0000 		sts rx_failure_cnt+3,r27
 1695               	.L72:
 517:../../../../src/net/bmac/rf231_soc/bmac.c **** 		rf_rx_off ();
 1697               	.LM185:
 1698 048c 0E94 0000 		call rf_rx_off
 518:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return 0;
 1700               	.LM186:
 1701 0490 80E0      		ldi r24,0
 1702 0492 0895      		ret
 1703               	.L71:
 519:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 520:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 521:../../../../src/net/bmac/rf231_soc/bmac.c **** 	/*while ( rf_rx_packet_nonblock() != NRK_OK )
 522:../../../../src/net/bmac/rf231_soc/bmac.c **** 	  {
 523:../../../../src/net/bmac/rf231_soc/bmac.c **** 	  cnt++;
 524:../../../../src/net/bmac/rf231_soc/bmac.c **** 	  nrk_wait(_bmac_check_period);
 525:../../../../src/net/bmac/rf231_soc/bmac.c **** 	  if(cnt>2) { 
 526:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 527:../../../../src/net/bmac/rf231_soc/bmac.c **** printf( "rx timeout 1 %d\r\n",cnt );
 528:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 529:../../../../src/net/bmac/rf231_soc/bmac.c **** if(rx_failure_cnt<65535) rx_failure_cnt++;
 530:../../../../src/net/bmac/rf231_soc/bmac.c **** rf_rx_off();
 531:../../../../src/net/bmac/rf231_soc/bmac.c **** return 0;
 532:../../../../src/net/bmac/rf231_soc/bmac.c **** } 
 533:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 534:../../../../src/net/bmac/rf231_soc/bmac.c **** */
 535:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 536:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 537:../../../../src/net/bmac/rf231_soc/bmac.c **** rx_buf_empty = 0;
 1705               	.LM187:
 1706 0494 1092 0000 		sts rx_buf_empty,__zero_reg__
 538:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 539:../../../../src/net/bmac/rf231_soc/bmac.c **** printf ("BMAC: SNR= %d [", bmac_rfRxInfo.rssi);
 540:../../../../src/net/bmac/rf231_soc/bmac.c **** for (uint8_t i = 0; i < bmac_rfRxInfo.length; i++)
 541:../../../../src/net/bmac/rf231_soc/bmac.c **** printf ("%c", bmac_rfRxInfo.pPayload[i]);
 542:../../../../src/net/bmac/rf231_soc/bmac.c **** printf ("]\r\n");
 543:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 544:../../../../src/net/bmac/rf231_soc/bmac.c **** rf_rx_off ();
 1708               	.LM188:
 1709 0498 0E94 0000 		call rf_rx_off
 545:../../../../src/net/bmac/rf231_soc/bmac.c **** return 1;
 1711               	.LM189:
 1712 049c 81E0      		ldi r24,lo8(1)
 546:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1714               	.LM190:
 1715 049e 0895      		ret
 1717               	.Lscope34:
 1719               		.stabd	78,0,0
 1721               	.global	bmac_rx_failure_count_get
 1723               	bmac_rx_failure_count_get:
 1724               		.stabd	46,0,0
 547:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 548:../../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_rx_failure_count_get ()
 549:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1726               	.LM191:
 1727               	.LFBB35:
 1728               	/* prologue: function */
 1729               	/* frame size = 0 */
 1730               	/* stack size = 0 */
 1731               	.L__stack_usage = 0
 550:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return rx_failure_cnt;
 551:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1733               	.LM192:
 1734 04a0 8091 0000 		lds r24,rx_failure_cnt
 1735 04a4 9091 0000 		lds r25,rx_failure_cnt+1
 1736 04a8 0895      		ret
 1738               	.Lscope35:
 1740               		.stabd	78,0,0
 1742               	.global	bmac_rx_failure_count_reset
 1744               	bmac_rx_failure_count_reset:
 1745               		.stabd	46,0,0
 552:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 553:../../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t bmac_rx_failure_count_reset ()
 554:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1747               	.LM193:
 1748               	.LFBB36:
 1749               	/* prologue: function */
 1750               	/* frame size = 0 */
 1751               	/* stack size = 0 */
 1752               	.L__stack_usage = 0
 555:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rx_failure_cnt = 0;
 1754               	.LM194:
 1755 04aa 1092 0000 		sts rx_failure_cnt,__zero_reg__
 1756 04ae 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 1757 04b2 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 1758 04b6 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 556:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 557:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1760               	.LM195:
 1761 04ba 81E0      		ldi r24,lo8(1)
 1762 04bc 0895      		ret
 1764               	.Lscope36:
 1766               		.stabd	78,0,0
 1769               	.global	_b_pow
 1771               	_b_pow:
 1772               		.stabd	46,0,0
 558:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 559:../../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_tx ()
 560:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 561:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t v, backoff, backoff_count, rf_tx_err;
 562:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint16_t b;
 563:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 564:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_time_t curr_t, target_t, dummy_t;
 565:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 566:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 567:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_kprintf (PSTR ("_bmac_tx()\r\n"));
 568:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 569:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (cca_active) {
 570:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 571:../../../../src/net/bmac/rf231_soc/bmac.c **** 		// Add random time here to stop nodes from synchronizing with eachother
 572:../../../../src/net/bmac/rf231_soc/bmac.c **** 		b = _nrk_time_to_ticks (&_bmac_check_period);
 573:../../../../src/net/bmac/rf231_soc/bmac.c **** 		b = b / ((rand () % 10) + 1);
 574:../../../../src/net/bmac/rf231_soc/bmac.c **** 		//printf( "waiting %d\r\n",b );
 575:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_wait_until_ticks (b);
 576:../../../../src/net/bmac/rf231_soc/bmac.c **** 		//nrk_wait_ticks(b);
 577:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 578:../../../../src/net/bmac/rf231_soc/bmac.c **** 		backoff_count = 1;
 579:../../../../src/net/bmac/rf231_soc/bmac.c **** 		do {
 580:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 581:../../../../src/net/bmac/rf231_soc/bmac.c **** 			v=_bmac_rx();
 582:../../../../src/net/bmac/rf231_soc/bmac.c **** 			v=!v;
 583:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (v == 1) { 
 584:../../../../src/net/bmac/rf231_soc/bmac.c **** 				break; 
 585:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 586:../../../../src/net/bmac/rf231_soc/bmac.c **** 			nrk_event_signal (bmac_rx_pkt_signal);
 587:../../../../src/net/bmac/rf231_soc/bmac.c **** #else
 588:../../../../src/net/bmac/rf231_soc/bmac.c **** 			v = _bmac_channel_check ();
 589:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (v == 1)
 590:../../../../src/net/bmac/rf231_soc/bmac.c **** 				break;
 591:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 592:../../../../src/net/bmac/rf231_soc/bmac.c **** 			// Channel is busy
 593:../../../../src/net/bmac/rf231_soc/bmac.c **** 			backoff = rand () % (_b_pow (backoff_count));
 594:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 595:../../../../src/net/bmac/rf231_soc/bmac.c **** 			printf ("backoff %d\r\n", backoff);
 596:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 597:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      printf( "backoff %d\r\n",backoff );
 598:../../../../src/net/bmac/rf231_soc/bmac.c **** 			nrk_wait_until_next_n_periods (backoff);
 599:../../../../src/net/bmac/rf231_soc/bmac.c **** 			backoff_count++;
 600:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (backoff_count > 6)
 601:../../../../src/net/bmac/rf231_soc/bmac.c **** 				backoff_count = 6;      // cap it at 64    
 602:../../../../src/net/bmac/rf231_soc/bmac.c **** 			b = _nrk_time_to_ticks (&_bmac_check_period);
 603:../../../../src/net/bmac/rf231_soc/bmac.c **** 			b = b / ((rand () % 10) + 1);
 604:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      printf( "waiting %d\r\n",b );
 605:../../../../src/net/bmac/rf231_soc/bmac.c **** 			nrk_wait_until_ticks (b);
 606:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      nrk_wait_ticks(b);
 607:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 608:../../../../src/net/bmac/rf231_soc/bmac.c **** 		}
 609:../../../../src/net/bmac/rf231_soc/bmac.c **** 		while (v == 0);
 610:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 611:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 612:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// send extended preamble
 613:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.cca = 0;
 614:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.ackRequest = 0;
 615:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 616:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint16_t ms = _bmac_check_period.secs * 1000;
 617:../../../../src/net/bmac/rf231_soc/bmac.c **** 	ms += _bmac_check_period.nano_secs / 1000000;
 618:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//printf( "CR ms: %u\n",ms );
 619:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//target_t.nano_secs+=20*NANOS_PER_MS;
 620:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_time_get(&curr_t);
 621:../../../../src/net/bmac/rf231_soc/bmac.c **** 	target_t.secs = curr_t.secs;
 622:../../../../src/net/bmac/rf231_soc/bmac.c **** 	target_t.nano_secs = curr_t.nano_secs + (ms * NANOS_PER_MS);
 623:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_time_compact_nanos(&target_t);
 624:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 625:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_rx_on ();
 626:../../../../src/net/bmac/rf231_soc/bmac.c **** 	pkt_got_ack = rf_tx_packet(&bmac_rfTxInfo);
 627:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_pll_on();
 628:../../../../src/net/bmac/rf231_soc/bmac.c **** 	do{
 629:../../../../src/net/bmac/rf231_soc/bmac.c **** 		rf_tx_err = rf_tx_packet_resend();
 630:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if(rf_tx_err == NRK_OK) pkt_got_ack = NRK_OK;
 631:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_time_get(&curr_t);
 632:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}while(nrk_time_sub(&dummy_t, target_t, curr_t) != NRK_ERROR);
 633:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 634:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 635:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// send packet
 636:../../../../src/net/bmac/rf231_soc/bmac.c **** 	// pkt_got_ack=rf_tx_packet (&bmac_rfTxInfo);
 637:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_rx_off ();                 // Just in case auto-ack left radio on
 638:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 0;
 639:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_event_signal (bmac_tx_pkt_done_signal);
 640:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 641:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 642:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 643:../../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t _b_pow (uint8_t in)
 644:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 1774               	.LM196:
 1775               	.LFBB37:
 1776               	/* prologue: function */
 1777               	/* frame size = 0 */
 1778               	/* stack size = 0 */
 1779               	.L__stack_usage = 0
 645:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t i;
 646:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t result;
 647:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (in <= 1)
 1781               	.LM197:
 1782 04be 8230      		cpi r24,lo8(2)
 1783 04c0 00F0      		brlo .L80
 648:../../../../src/net/bmac/rf231_soc/bmac.c **** 		return 1;
 649:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (in > 7)
 1785               	.LM198:
 1786 04c2 8830      		cpi r24,lo8(8)
 1787 04c4 00F0      		brlo .L78
 650:../../../../src/net/bmac/rf231_soc/bmac.c **** 		in = 6;                     // cap it at 128 
 1789               	.LM199:
 1790 04c6 86E0      		ldi r24,lo8(6)
 1791               	.L78:
 651:../../../../src/net/bmac/rf231_soc/bmac.c **** 	result = 1;
 1793               	.LM200:
 1794 04c8 91E0      		ldi r25,lo8(1)
 652:../../../../src/net/bmac/rf231_soc/bmac.c **** 	for (i = 0; i < in; i++)
 1796               	.LM201:
 1797 04ca 20E0      		ldi r18,0
 1798               	.L79:
 653:../../../../src/net/bmac/rf231_soc/bmac.c **** 		result = result * 2;
 1800               	.LM202:
 1801 04cc 990F      		lsl r25
 652:../../../../src/net/bmac/rf231_soc/bmac.c **** 	for (i = 0; i < in; i++)
 1803               	.LM203:
 1804 04ce 2F5F      		subi r18,lo8(-(1))
 1805 04d0 2813      		cpse r18,r24
 1806 04d2 00C0      		rjmp .L79
 654:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return result;
 1808               	.LM204:
 1809 04d4 892F      		mov r24,r25
 1810 04d6 0895      		ret
 1811               	.L80:
 648:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (in > 7)
 1813               	.LM205:
 1814 04d8 81E0      		ldi r24,lo8(1)
 655:../../../../src/net/bmac/rf231_soc/bmac.c **** }
 1816               	.LM206:
 1817 04da 0895      		ret
 1823               	.Lscope37:
 1825               		.stabd	78,0,0
 1827               	.global	_bmac_tx
 1829               	_bmac_tx:
 1830               		.stabd	46,0,0
 560:../../../../src/net/bmac/rf231_soc/bmac.c **** 	uint8_t v, backoff, backoff_count, rf_tx_err;
 1832               	.LM207:
 1833               	.LFBB38:
 1834 04dc 8F92      		push r8
 1835 04de 9F92      		push r9
 1836 04e0 AF92      		push r10
 1837 04e2 BF92      		push r11
 1838 04e4 CF92      		push r12
 1839 04e6 DF92      		push r13
 1840 04e8 EF92      		push r14
 1841 04ea FF92      		push r15
 1842 04ec 0F93      		push r16
 1843 04ee 1F93      		push r17
 1844 04f0 CF93      		push r28
 1845 04f2 DF93      		push r29
 1846 04f4 CDB7      		in r28,__SP_L__
 1847 04f6 DEB7      		in r29,__SP_H__
 1848 04f8 6897      		sbiw r28,24
 1849 04fa 0FB6      		in __tmp_reg__,__SREG__
 1850 04fc F894      		cli
 1851 04fe DEBF      		out __SP_H__,r29
 1852 0500 0FBE      		out __SREG__,__tmp_reg__
 1853 0502 CDBF      		out __SP_L__,r28
 1854               	/* prologue: function */
 1855               	/* frame size = 24 */
 1856               	/* stack size = 36 */
 1857               	.L__stack_usage = 36
 569:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 1859               	.LM208:
 1860 0504 8091 0000 		lds r24,cca_active
 1861 0508 8111      		cpse r24,__zero_reg__
 1862 050a 00C0      		rjmp .L83
 1863               	.L85:
 613:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_rfTxInfo.ackRequest = 0;
 1865               	.LM209:
 1866 050c 1092 0000 		sts bmac_rfTxInfo+5,__zero_reg__
 614:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 1868               	.LM210:
 1869 0510 1092 0000 		sts bmac_rfTxInfo+6,__zero_reg__
 616:../../../../src/net/bmac/rf231_soc/bmac.c **** 	ms += _bmac_check_period.nano_secs / 1000000;
 1871               	.LM211:
 1872 0514 2091 0000 		lds r18,_bmac_check_period
 1873 0518 3091 0000 		lds r19,_bmac_check_period+1
 1874 051c 88EE      		ldi r24,lo8(-24)
 1875 051e 93E0      		ldi r25,lo8(3)
 1876 0520 289F      		mul r18,r24
 1877 0522 8001      		movw r16,r0
 1878 0524 299F      		mul r18,r25
 1879 0526 100D      		add r17,r0
 1880 0528 389F      		mul r19,r24
 1881 052a 100D      		add r17,r0
 1882 052c 1124      		clr r1
 617:../../../../src/net/bmac/rf231_soc/bmac.c **** 	//printf( "CR ms: %u\n",ms );
 1884               	.LM212:
 1885 052e 6091 0000 		lds r22,_bmac_check_period+4
 1886 0532 7091 0000 		lds r23,_bmac_check_period+4+1
 1887 0536 8091 0000 		lds r24,_bmac_check_period+4+2
 1888 053a 9091 0000 		lds r25,_bmac_check_period+4+3
 1889 053e 20E4      		ldi r18,lo8(64)
 1890 0540 32E4      		ldi r19,lo8(66)
 1891 0542 4FE0      		ldi r20,lo8(15)
 1892 0544 50E0      		ldi r21,0
 1893 0546 0E94 0000 		call __udivmodsi4
 1894 054a 020F      		add r16,r18
 1895 054c 131F      		adc r17,r19
 620:../../../../src/net/bmac/rf231_soc/bmac.c **** 	target_t.secs = curr_t.secs;
 1897               	.LM213:
 1898 054e CE01      		movw r24,r28
 1899 0550 4196      		adiw r24,17
 1900 0552 0E94 0000 		call nrk_time_get
 621:../../../../src/net/bmac/rf231_soc/bmac.c **** 	target_t.nano_secs = curr_t.nano_secs + (ms * NANOS_PER_MS);
 1902               	.LM214:
 1903 0556 8989      		ldd r24,Y+17
 1904 0558 9A89      		ldd r25,Y+18
 1905 055a AB89      		ldd r26,Y+19
 1906 055c BC89      		ldd r27,Y+20
 1907 055e 8987      		std Y+9,r24
 1908 0560 9A87      		std Y+10,r25
 1909 0562 AB87      		std Y+11,r26
 1910 0564 BC87      		std Y+12,r27
 622:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_time_compact_nanos(&target_t);
 1912               	.LM215:
 1913 0566 D801      		movw r26,r16
 1914 0568 20E4      		ldi r18,lo8(64)
 1915 056a 32E4      		ldi r19,lo8(66)
 1916 056c 4FE0      		ldi r20,lo8(15)
 1917 056e 50E0      		ldi r21,0
 1918 0570 0E94 0000 		call __muluhisi3
 1919 0574 0D89      		ldd r16,Y+21
 1920 0576 1E89      		ldd r17,Y+22
 1921 0578 2F89      		ldd r18,Y+23
 1922 057a 388D      		ldd r19,Y+24
 1923 057c DC01      		movw r26,r24
 1924 057e CB01      		movw r24,r22
 1925 0580 800F      		add r24,r16
 1926 0582 911F      		adc r25,r17
 1927 0584 A21F      		adc r26,r18
 1928 0586 B31F      		adc r27,r19
 1929 0588 8D87      		std Y+13,r24
 1930 058a 9E87      		std Y+14,r25
 1931 058c AF87      		std Y+15,r26
 1932 058e B88B      		std Y+16,r27
 623:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 1934               	.LM216:
 1935 0590 CE01      		movw r24,r28
 1936 0592 0996      		adiw r24,9
 1937 0594 0E94 0000 		call nrk_time_compact_nanos
 625:../../../../src/net/bmac/rf231_soc/bmac.c **** 	pkt_got_ack = rf_tx_packet(&bmac_rfTxInfo);
 1939               	.LM217:
 1940 0598 0E94 0000 		call rf_rx_on
 626:../../../../src/net/bmac/rf231_soc/bmac.c **** 	rf_pll_on();
 1942               	.LM218:
 1943 059c 80E0      		ldi r24,lo8(bmac_rfTxInfo)
 1944 059e 90E0      		ldi r25,hi8(bmac_rfTxInfo)
 1945 05a0 0E94 0000 		call rf_tx_packet
 1946 05a4 8093 0000 		sts pkt_got_ack,r24
 627:../../../../src/net/bmac/rf231_soc/bmac.c **** 	do{
 1948               	.LM219:
 1949 05a8 0E94 0000 		call rf_pll_on
 1950 05ac 00C0      		rjmp .L84
 1951               	.L83:
 572:../../../../src/net/bmac/rf231_soc/bmac.c **** 		b = b / ((rand () % 10) + 1);
 1953               	.LM220:
 1954 05ae 80E0      		ldi r24,lo8(_bmac_check_period)
 1955 05b0 90E0      		ldi r25,hi8(_bmac_check_period)
 1956 05b2 0E94 0000 		call _nrk_time_to_ticks
 1957 05b6 8C01      		movw r16,r24
 573:../../../../src/net/bmac/rf231_soc/bmac.c **** 		//printf( "waiting %d\r\n",b );
 1959               	.LM221:
 1960 05b8 0E94 0000 		call rand
 1961 05bc 6AE0      		ldi r22,lo8(10)
 1962 05be 70E0      		ldi r23,0
 1963 05c0 0E94 0000 		call __divmodhi4
 1964 05c4 BC01      		movw r22,r24
 1965 05c6 6F5F      		subi r22,-1
 1966 05c8 7F4F      		sbci r23,-1
 1967 05ca C801      		movw r24,r16
 1968 05cc 0E94 0000 		call __udivmodhi4
 1969 05d0 CB01      		movw r24,r22
 575:../../../../src/net/bmac/rf231_soc/bmac.c **** 		//nrk_wait_ticks(b);
 1971               	.LM222:
 1972 05d2 0E94 0000 		call nrk_wait_until_ticks
 578:../../../../src/net/bmac/rf231_soc/bmac.c **** 		do {
 1974               	.LM223:
 1975 05d6 11E0      		ldi r17,lo8(1)
 603:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      printf( "waiting %d\r\n",b );
 1977               	.LM224:
 1978 05d8 8AE0      		ldi r24,lo8(10)
 1979 05da E82E      		mov r14,r24
 1980 05dc F12C      		mov r15,__zero_reg__
 1981               	.L87:
 588:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (v == 1)
 1983               	.LM225:
 1984 05de 0E94 0000 		call _bmac_channel_check
 1985 05e2 082F      		mov r16,r24
 589:../../../../src/net/bmac/rf231_soc/bmac.c **** 				break;
 1987               	.LM226:
 1988 05e4 8130      		cpi r24,lo8(1)
 1989 05e6 01F4      		brne .+2
 1990 05e8 00C0      		rjmp .L85
 593:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 1992               	.LM227:
 1993 05ea 0E94 0000 		call rand
 1994 05ee 6C01      		movw r12,r24
 1995 05f0 812F      		mov r24,r17
 1996 05f2 0E94 0000 		call _b_pow
 1997 05f6 682F      		mov r22,r24
 1998 05f8 70E0      		ldi r23,0
 1999 05fa C601      		movw r24,r12
 2000 05fc 0E94 0000 		call __divmodhi4
 598:../../../../src/net/bmac/rf231_soc/bmac.c **** 			backoff_count++;
 2002               	.LM228:
 2003 0600 9927      		clr r25
 2004 0602 0E94 0000 		call nrk_wait_until_next_n_periods
 599:../../../../src/net/bmac/rf231_soc/bmac.c **** 			if (backoff_count > 6)
 2006               	.LM229:
 2007 0606 1F5F      		subi r17,lo8(-(1))
 2008 0608 1730      		cpi r17,lo8(7)
 2009 060a 00F0      		brlo .L86
 2010 060c 16E0      		ldi r17,lo8(6)
 2011               	.L86:
 602:../../../../src/net/bmac/rf231_soc/bmac.c **** 			b = b / ((rand () % 10) + 1);
 2013               	.LM230:
 2014 060e 80E0      		ldi r24,lo8(_bmac_check_period)
 2015 0610 90E0      		ldi r25,hi8(_bmac_check_period)
 2016 0612 0E94 0000 		call _nrk_time_to_ticks
 2017 0616 6C01      		movw r12,r24
 603:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      printf( "waiting %d\r\n",b );
 2019               	.LM231:
 2020 0618 0E94 0000 		call rand
 2021 061c B701      		movw r22,r14
 2022 061e 0E94 0000 		call __divmodhi4
 2023 0622 BC01      		movw r22,r24
 2024 0624 6F5F      		subi r22,-1
 2025 0626 7F4F      		sbci r23,-1
 2026 0628 C601      		movw r24,r12
 2027 062a 0E94 0000 		call __udivmodhi4
 2028 062e CB01      		movw r24,r22
 605:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      nrk_wait_ticks(b);
 2030               	.LM232:
 2031 0630 0E94 0000 		call nrk_wait_until_ticks
 609:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 2033               	.LM233:
 2034 0634 0023      		tst r16
 2035 0636 01F0      		breq .L87
 2036 0638 00C0      		rjmp .L85
 2037               	.L84:
 629:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if(rf_tx_err == NRK_OK) pkt_got_ack = NRK_OK;
 2039               	.LM234:
 2040 063a 0E94 0000 		call rf_tx_packet_resend
 630:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_time_get(&curr_t);
 2042               	.LM235:
 2043 063e 8130      		cpi r24,lo8(1)
 2044 0640 01F4      		brne .L88
 630:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_time_get(&curr_t);
 2046               	.LM236:
 2047 0642 8093 0000 		sts pkt_got_ack,r24
 2048               	.L88:
 631:../../../../src/net/bmac/rf231_soc/bmac.c **** 	}while(nrk_time_sub(&dummy_t, target_t, curr_t) != NRK_ERROR);
 2050               	.LM237:
 2051 0646 CE01      		movw r24,r28
 2052 0648 4196      		adiw r24,17
 2053 064a 0E94 0000 		call nrk_time_get
 632:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 2055               	.LM238:
 2056 064e 8988      		ldd r8,Y+17
 2057 0650 9A88      		ldd r9,Y+18
 2058 0652 AB88      		ldd r10,Y+19
 2059 0654 BC88      		ldd r11,Y+20
 2060 0656 CD88      		ldd r12,Y+21
 2061 0658 DE88      		ldd r13,Y+22
 2062 065a EF88      		ldd r14,Y+23
 2063 065c F88C      		ldd r15,Y+24
 2064 065e 0985      		ldd r16,Y+9
 2065 0660 1A85      		ldd r17,Y+10
 2066 0662 2B85      		ldd r18,Y+11
 2067 0664 3C85      		ldd r19,Y+12
 2068 0666 4D85      		ldd r20,Y+13
 2069 0668 5E85      		ldd r21,Y+14
 2070 066a 6F85      		ldd r22,Y+15
 2071 066c 7889      		ldd r23,Y+16
 2072 066e CE01      		movw r24,r28
 2073 0670 0196      		adiw r24,1
 2074 0672 0E94 0000 		call nrk_time_sub
 2075 0676 8F3F      		cpi r24,lo8(-1)
 2076 0678 01F4      		brne .L84
 637:../../../../src/net/bmac/rf231_soc/bmac.c **** 	tx_data_ready = 0;
 2078               	.LM239:
 2079 067a 0E94 0000 		call rf_rx_off
 638:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_event_signal (bmac_tx_pkt_done_signal);
 2081               	.LM240:
 2082 067e 1092 0000 		sts tx_data_ready,__zero_reg__
 639:../../../../src/net/bmac/rf231_soc/bmac.c **** 	return NRK_OK;
 2084               	.LM241:
 2085 0682 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 2086 0686 0E94 0000 		call nrk_event_signal
 641:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 2088               	.LM242:
 2089 068a 81E0      		ldi r24,lo8(1)
 2090               	/* epilogue start */
 2091 068c 6896      		adiw r28,24
 2092 068e 0FB6      		in __tmp_reg__,__SREG__
 2093 0690 F894      		cli
 2094 0692 DEBF      		out __SP_H__,r29
 2095 0694 0FBE      		out __SREG__,__tmp_reg__
 2096 0696 CDBF      		out __SP_L__,r28
 2097 0698 DF91      		pop r29
 2098 069a CF91      		pop r28
 2099 069c 1F91      		pop r17
 2100 069e 0F91      		pop r16
 2101 06a0 FF90      		pop r15
 2102 06a2 EF90      		pop r14
 2103 06a4 DF90      		pop r13
 2104 06a6 CF90      		pop r12
 2105 06a8 BF90      		pop r11
 2106 06aa AF90      		pop r10
 2107 06ac 9F90      		pop r9
 2108 06ae 8F90      		pop r8
 2109 06b0 0895      		ret
 2118               	.Lscope38:
 2120               		.stabd	78,0,0
 2122               	.global	bmac_nw_task
 2124               	bmac_nw_task:
 2125               		.stabd	46,0,0
 391:../../../../src/net/bmac/rf231_soc/bmac.c **** 	int8_t v, i;
 2127               	.LM243:
 2128               	.LFBB39:
 2129               	/* prologue: function */
 2130               	/* frame size = 0 */
 2131               	/* stack size = 0 */
 2132               	.L__stack_usage = 0
 2133               	.L96:
 397:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_wait_until_next_period ();
 2135               	.LM244:
 2136 06b2 8091 0000 		lds r24,bmac_running
 2137 06b6 8111      		cpse r24,__zero_reg__
 2138 06b8 00C0      		rjmp .L112
 398:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 2140               	.LM245:
 2141 06ba 0E94 0000 		call nrk_wait_until_next_period
 2142 06be 00C0      		rjmp .L96
 2143               	.L112:
 401:../../../../src/net/bmac/rf231_soc/bmac.c **** 	if (v == NRK_ERROR)
 2145               	.LM246:
 2146 06c0 8091 0000 		lds r24,bmac_enable_signal
 2147 06c4 0E94 0000 		call nrk_signal_register
 402:../../../../src/net/bmac/rf231_soc/bmac.c **** 		nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 2149               	.LM247:
 2150 06c8 8F3F      		cpi r24,lo8(-1)
 2151 06ca 01F4      		brne .L98
 403:../../../../src/net/bmac/rf231_soc/bmac.c **** 	backoff = 0;
 2153               	.LM248:
 2154 06cc 80E0      		ldi r24,lo8(__c.3761)
 2155 06ce 90E0      		ldi r25,hi8(__c.3761)
 2156 06d0 0E94 0000 		call nrk_kprintf
 2157               	.L98:
 459:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 2159               	.LM249:
 2160 06d4 C12C      		mov r12,__zero_reg__
 2161 06d6 D12C      		mov r13,__zero_reg__
 2162 06d8 7601      		movw r14,r12
 2163 06da C394      		inc r12
 2164               	.L99:
 411:../../../../src/net/bmac/rf231_soc/bmac.c **** 		if (is_enabled) {
 2166               	.LM250:
 2167 06dc 0E94 0000 		call rf_power_up
 412:../../../../src/net/bmac/rf231_soc/bmac.c **** 			v = 1;
 2169               	.LM251:
 2170 06e0 8091 0000 		lds r24,is_enabled
 2171 06e4 8823      		tst r24
 2172 06e6 01F0      		breq .L109
 423:../../../../src/net/bmac/rf231_soc/bmac.c **** 				v = _bmac_channel_check ();
 2174               	.LM252:
 2175 06e8 8091 0000 		lds r24,rx_buf_empty
 2176 06ec 8130      		cpi r24,lo8(1)
 2177 06ee 01F4      		brne .L111
 424:../../../../src/net/bmac/rf231_soc/bmac.c **** 			// If the buffer is full, signal the receiving task again.
 2179               	.LM253:
 2180 06f0 0E94 0000 		call _bmac_channel_check
 431:../../../../src/net/bmac/rf231_soc/bmac.c **** 				if (_bmac_rx () == 1) {
 2182               	.LM254:
 2183 06f4 8111      		cpse r24,__zero_reg__
 2184 06f6 00C0      		rjmp .L103
 432:../../../../src/net/bmac/rf231_soc/bmac.c **** 					e = nrk_event_signal (bmac_rx_pkt_signal);
 2186               	.LM255:
 2187 06f8 0E94 0000 		call _bmac_rx
 2188 06fc 8130      		cpi r24,lo8(1)
 2189 06fe 01F4      		brne .L103
 2190               	.L111:
 433:../../../../src/net/bmac/rf231_soc/bmac.c **** 					//if(e==NRK_ERROR) {
 2192               	.LM256:
 2193 0700 8091 0000 		lds r24,bmac_rx_pkt_signal
 2194 0704 0E94 0000 		call nrk_event_signal
 2195               	.L103:
 444:../../../../src/net/bmac/rf231_soc/bmac.c **** 				_bmac_tx ();
 2197               	.LM257:
 2198 0708 8091 0000 		lds r24,tx_data_ready
 2199 070c 8130      		cpi r24,lo8(1)
 2200 070e 01F4      		brne .L105
 445:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 2202               	.LM258:
 2203 0710 0E94 0000 		call _bmac_tx
 2204               	.L105:
 447:../../../../src/net/bmac/rf231_soc/bmac.c **** 			rf_power_down ();
 2206               	.LM259:
 2207 0714 0E94 0000 		call rf_rx_off
 448:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 2209               	.LM260:
 2210 0718 0E94 0000 		call rf_power_down
 451:../../../../src/net/bmac/rf231_soc/bmac.c **** 			//      if(rx_buf_empty!=1)  nrk_event_signal (bmac_rx_pkt_signal);
 2212               	.LM261:
 2213 071c 2091 0000 		lds r18,_bmac_check_period
 2214 0720 3091 0000 		lds r19,_bmac_check_period+1
 2215 0724 4091 0000 		lds r20,_bmac_check_period+2
 2216 0728 5091 0000 		lds r21,_bmac_check_period+3
 2217 072c 6091 0000 		lds r22,_bmac_check_period+4
 2218 0730 7091 0000 		lds r23,_bmac_check_period+5
 2219 0734 8091 0000 		lds r24,_bmac_check_period+6
 2220 0738 9091 0000 		lds r25,_bmac_check_period+7
 2221 073c 0E94 0000 		call nrk_wait
 2222 0740 00C0      		rjmp .L99
 2223               	.L109:
 458:../../../../src/net/bmac/rf231_soc/bmac.c **** 				event = nrk_event_wait (SIG (bmac_enable_signal));
 2225               	.LM262:
 2226 0742 8091 0000 		lds r24,bmac_enable_signal
 2227 0746 0E94 0000 		call nrk_signal_register
 459:../../../../src/net/bmac/rf231_soc/bmac.c **** 			}
 2229               	.LM263:
 2230 074a C701      		movw r24,r14
 2231 074c B601      		movw r22,r12
 2232 074e 0090 0000 		lds r0,bmac_enable_signal
 2233 0752 00C0      		rjmp 2f
 2234               		1:
 2235 0754 660F      		lsl r22
 2236 0756 771F      		rol r23
 2237 0758 881F      		rol r24
 2238 075a 991F      		rol r25
 2239               		2:
 2240 075c 0A94      		dec r0
 2241 075e 02F4      		brpl 1b
 2242 0760 0E94 0000 		call nrk_event_wait
 461:../../../../src/net/bmac/rf231_soc/bmac.c **** 		}
 2244               	.LM264:
 2245 0764 DC01      		movw r26,r24
 2246 0766 CB01      		movw r24,r22
 2247 0768 0090 0000 		lds r0,bmac_enable_signal
 2248 076c 00C0      		rjmp 2f
 2249               		1:
 2250 076e B695      		lsr r27
 2251 0770 A795      		ror r26
 2252 0772 9795      		ror r25
 2253 0774 8795      		ror r24
 2254               		2:
 2255 0776 0A94      		dec r0
 2256 0778 02F4      		brpl 1b
 2257 077a 80FF      		sbrs r24,0
 2258 077c 00C0      		rjmp .L109
 2259 077e 00C0      		rjmp .L99
 2264               	.Lscope39:
 2266               		.stabd	78,0,0
 2268               	.global	bmac_task_config
 2270               	bmac_task_config:
 2271               		.stabd	46,0,0
 656:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 657:../../../../src/net/bmac/rf231_soc/bmac.c **** 
 658:../../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_task_config ()
 659:../../../../src/net/bmac/rf231_soc/bmac.c **** {
 2273               	.LM265:
 2274               	.LFBB40:
 2275               	/* prologue: function */
 2276               	/* frame size = 0 */
 2277               	/* stack size = 0 */
 2278               	.L__stack_usage = 0
 660:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_task_set_entry_function (&bmac_task, bmac_nw_task);
 2280               	.LM266:
 2281 0780 60E0      		ldi r22,lo8(gs(bmac_nw_task))
 2282 0782 70E0      		ldi r23,hi8(gs(bmac_nw_task))
 2283 0784 80E0      		ldi r24,lo8(bmac_task)
 2284 0786 90E0      		ldi r25,hi8(bmac_task)
 2285 0788 0E94 0000 		call nrk_task_set_entry_function
 661:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_task_set_stk (&bmac_task, bmac_task_stack, BMAC_STACKSIZE);
 2287               	.LM267:
 2288 078c 40E0      		ldi r20,0
 2289 078e 51E0      		ldi r21,lo8(1)
 2290 0790 60E0      		ldi r22,lo8(bmac_task_stack)
 2291 0792 70E0      		ldi r23,hi8(bmac_task_stack)
 2292 0794 80E0      		ldi r24,lo8(bmac_task)
 2293 0796 90E0      		ldi r25,hi8(bmac_task)
 2294 0798 0E94 0000 		call nrk_task_set_stk
 662:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.prio = BMAC_TASK_PRIORITY;
 2296               	.LM268:
 2297 079c E0E0      		ldi r30,lo8(bmac_task)
 2298 079e F0E0      		ldi r31,hi8(bmac_task)
 2299 07a0 84E1      		ldi r24,lo8(20)
 2300 07a2 8087      		std Z+8,r24
 663:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.FirstActivation = TRUE;
 2302               	.LM269:
 2303 07a4 81E0      		ldi r24,lo8(1)
 2304 07a6 8783      		std Z+7,r24
 664:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.Type = BASIC_TASK;
 2306               	.LM270:
 2307 07a8 8187      		std Z+9,r24
 665:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.SchType = PREEMPTIVE;
 2309               	.LM271:
 2310 07aa 8287      		std Z+10,r24
 666:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.period.secs = 0;
 2312               	.LM272:
 2313 07ac 1386      		std Z+11,__zero_reg__
 2314 07ae 1486      		std Z+12,__zero_reg__
 2315 07b0 1586      		std Z+13,__zero_reg__
 2316 07b2 1686      		std Z+14,__zero_reg__
 667:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.period.nano_secs = BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS;
 2318               	.LM273:
 2319 07b4 80E0      		ldi r24,0
 2320 07b6 9DE2      		ldi r25,lo8(45)
 2321 07b8 A1E3      		ldi r26,lo8(49)
 2322 07ba B1E0      		ldi r27,lo8(1)
 2323 07bc 8787      		std Z+15,r24
 2324 07be 908B      		std Z+16,r25
 2325 07c0 A18B      		std Z+17,r26
 2326 07c2 B28B      		std Z+18,r27
 668:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.cpu_reserve.secs = 0;       // bmac reserve , 0 to disable
 2328               	.LM274:
 2329 07c4 138A      		std Z+19,__zero_reg__
 2330 07c6 148A      		std Z+20,__zero_reg__
 2331 07c8 158A      		std Z+21,__zero_reg__
 2332 07ca 168A      		std Z+22,__zero_reg__
 669:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.cpu_reserve.nano_secs = 0;
 2334               	.LM275:
 2335 07cc 178A      		std Z+23,__zero_reg__
 2336 07ce 108E      		std Z+24,__zero_reg__
 2337 07d0 118E      		std Z+25,__zero_reg__
 2338 07d2 128E      		std Z+26,__zero_reg__
 670:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.offset.secs = 0;
 2340               	.LM276:
 2341 07d4 138E      		std Z+27,__zero_reg__
 2342 07d6 148E      		std Z+28,__zero_reg__
 2343 07d8 158E      		std Z+29,__zero_reg__
 2344 07da 168E      		std Z+30,__zero_reg__
 671:../../../../src/net/bmac/rf231_soc/bmac.c **** 	bmac_task.offset.nano_secs = 0;
 2346               	.LM277:
 2347 07dc 178E      		std Z+31,__zero_reg__
 2348 07de 10A2      		std Z+32,__zero_reg__
 2349 07e0 11A2      		std Z+33,__zero_reg__
 2350 07e2 12A2      		std Z+34,__zero_reg__
 672:../../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 673:../../../../src/net/bmac/rf231_soc/bmac.c **** 	printf ("bmac activate\r\n");
 674:../../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 675:../../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_activate_task (&bmac_task);
 2352               	.LM278:
 2353 07e4 CF01      		movw r24,r30
 2354 07e6 0C94 0000 		jmp nrk_activate_task
 2356               	.Lscope40:
 2358               		.stabd	78,0,0
 2359               		.section	.progmem.data,"a",@progbits
 2362               	__c.3761:
 2363 0000 4661 696C 		.string	"Failed to register signal\r\n"
 2363      6564 2074 
 2363      6F20 7265 
 2363      6769 7374 
 2363      6572 2073 
 2366               	__c.3735:
 2367 001c 424D 4143 		.string	"BMAC TX: Woke up on wrong signal\r\n"
 2367      2054 583A 
 2367      2057 6F6B 
 2367      6520 7570 
 2367      206F 6E20 
 2370               	__c.3733:
 2371 003f 424D 4143 		.string	"BMAC TX: Error calling event wait\r\n"
 2371      2054 583A 
 2371      2045 7272 
 2371      6F72 2063 
 2371      616C 6C69 
 2374               	__c.3717:
 2375 0063 424D 4143 		.string	"BMAC ERROR: creating enable signal failed\r\n"
 2375      2045 5252 
 2375      4F52 3A20 
 2375      6372 6561 
 2375      7469 6E67 
 2378               	__c.3715:
 2379 008f 424D 4143 		.string	"BMAC ERROR: creating tx signal failed\r\n"
 2379      2045 5252 
 2379      4F52 3A20 
 2379      6372 6561 
 2379      7469 6E67 
 2382               	__c.3713:
 2383 00b7 424D 4143 		.string	"BMAC ERROR: creating rx signal failed\r\n"
 2383      2045 5252 
 2383      4F52 3A20 
 2383      6372 6561 
 2383      7469 6E67 
 2384               		.local	dummy_t
 2385               		.comm	dummy_t,8,1
 2386               		.local	tx_reserve
 2387               		.comm	tx_reserve,1,1
 2388               		.local	cca_active
 2389               		.comm	cca_active,1,1
 2390               		.local	_bmac_check_period
 2391               		.comm	_bmac_check_period,8,1
 2392               		.local	is_enabled
 2393               		.comm	is_enabled,1,1
 2394               		.local	g_chan
 2395               		.comm	g_chan,1,1
 2396               		.local	pkt_got_ack
 2397               		.comm	pkt_got_ack,1,1
 2398               		.local	bmac_running
 2399               		.comm	bmac_running,1,1
 2400               		.local	rx_buf_empty
 2401               		.comm	rx_buf_empty,1,1
 2402               		.local	tx_data_ready
 2403               		.comm	tx_data_ready,1,1
 2404               		.local	rx_failure_cnt
 2405               		.comm	rx_failure_cnt,4,1
 2406               		.local	bmac_task_stack
 2407               		.comm	bmac_task_stack,256,1
 2408               		.local	bmac_task
 2409               		.comm	bmac_task,35,1
 2410               		.comm	bmac_rfTxInfo,7,1
 2411               		.comm	bmac_rfRxInfo,12,1
 2412               		.comm	bmac_enable_signal,1,1
 2413               		.comm	bmac_tx_pkt_done_signal,1,1
 2414               		.comm	bmac_rx_pkt_signal,1,1
 2415               		.comm	error_num,1,1
 2416               		.comm	error_task,1,1
 2417               		.comm	app_timer0_prescale,1,1
 2418               		.comm	app_timer0_callback,2,1
 2419               		.comm	_nrk_time_trigger,1,1
 2420               		.comm	_nrk_prev_timer_val,1,1
 2421               		.comm	nrk_kernel_stk_ptr,2,1
 2422               		.comm	nrk_idle_task_stk,128,1
 2423               		.comm	_nrk_signal_list,4,1
 2451               		.text
 2453               	.Letext0:
 2454               		.ident	"GCC: (GNU) 4.9.2"
 2455               	.global __do_clear_bss
DEFINED SYMBOLS
                            *ABS*:0000000000000000 bmac.c
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:4      *ABS*:000000000000003f __SREG__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:5      *ABS*:000000000000003b __RAMPZ__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:6      *ABS*:0000000000000000 __tmp_reg__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:7      *ABS*:0000000000000001 __zero_reg__
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:343    .text:0000000000000000 rf_rx_callback
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:364    .text:0000000000000002 bmac_encryption_set_ctr_counter
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:400    .text:0000000000000012 bmac_tx_reserve_set
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:420    .text:0000000000000016 bmac_tx_reserve_get
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:441    .text:000000000000001c bmac_auto_ack_disable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:464    .text:0000000000000024 bmac_auto_ack_enable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:487    .text:000000000000002c bmac_addr_decode_disable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:510    .text:0000000000000034 bmac_addr_decode_enable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:534    .text:000000000000003c bmac_addr_decode_set_my_mac
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:558    .text:0000000000000044 bmac_addr_decode_dest_mac
                            *COM*:0000000000000007 bmac_rfTxInfo
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:582    .text:0000000000000050 bmac_rx_pkt_is_encrypted
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:606    .text:0000000000000056 bmac_encryption_set_key
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:640    .text:0000000000000066 bmac_encryption_enable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:660    .text:000000000000006a bmac_encryption_disable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:681    .text:000000000000006e bmac_set_rf_power
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:716    .text:000000000000007e bmac_set_cca_active
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2387   .bss:0000000000000009 cca_active
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:737    .text:0000000000000084 bmac_set_cca_thresh
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:764    .text:0000000000000092 bmac_set_channel
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2393   .bss:0000000000000013 g_chan
                            *COM*:000000000000000c bmac_rfRxInfo
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:822    .text:00000000000000ca bmac_wait_until_rx_pkt
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2399   .bss:0000000000000016 rx_buf_empty
                            *COM*:0000000000000001 bmac_rx_pkt_signal
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:899    .text:000000000000011e bmac_rx_pkt_set_buffer
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:941    .text:000000000000013a bmac_init
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2397   .bss:0000000000000015 bmac_running
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2385   .bss:0000000000000008 tx_reserve
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2403   .bss:0000000000000018 rx_failure_cnt
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2389   .bss:000000000000000a _bmac_check_period
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2382   .progmem.data:00000000000000b7 __c.3713
                            *COM*:0000000000000001 bmac_tx_pkt_done_signal
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2378   .progmem.data:000000000000008f __c.3715
                            *COM*:0000000000000001 bmac_enable_signal
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2374   .progmem.data:0000000000000063 __c.3717
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2401   .bss:0000000000000017 tx_data_ready
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2391   .bss:0000000000000012 is_enabled
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1104   .text:0000000000000224 bmac_tx_pkt_nonblocking
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1147   .text:0000000000000246 bmac_get_rx_pkt_signal
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1171   .text:0000000000000254 bmac_get_tx_done_signal
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1197   .text:0000000000000262 bmac_tx_pkt
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2370   .progmem.data:000000000000003f __c.3733
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2366   .progmem.data:000000000000001c __c.3735
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2395   .bss:0000000000000014 pkt_got_ack
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1321   .text:00000000000002fe bmac_rx_pkt_get
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1373   .text:000000000000032e bmac_rx_pkt_ready
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1399   .text:000000000000033a bmac_rx_pkt_release
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1422   .text:0000000000000342 bmac_disable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1444   .text:000000000000034a bmac_enable
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1472   .text:000000000000035c bmac_set_rx_check_rate
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1565   .text:00000000000003e2 bmac_started
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1585   .text:00000000000003e8 _bmac_channel_check
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1630   .text:0000000000000410 _bmac_rx
                             .bss:0000000000000000 dummy_t
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1723   .text:00000000000004a0 bmac_rx_failure_count_get
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1744   .text:00000000000004aa bmac_rx_failure_count_reset
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1771   .text:00000000000004be _b_pow
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:1829   .text:00000000000004dc _bmac_tx
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2124   .text:00000000000006b2 bmac_nw_task
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2362   .progmem.data:0000000000000000 __c.3761
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2270   .text:0000000000000780 bmac_task_config
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2407   .bss:000000000000011c bmac_task
/var/folders/g6/tbq62m5x2cb4hdh54h_fbn3h0000gn/T//cca27ifh.s:2405   .bss:000000000000001c bmac_task_stack
                            *COM*:0000000000000001 error_num
                            *COM*:0000000000000001 error_task
                            *COM*:0000000000000001 app_timer0_prescale
                            *COM*:0000000000000002 app_timer0_callback
                            *COM*:0000000000000001 _nrk_time_trigger
                            *COM*:0000000000000001 _nrk_prev_timer_val
                            *COM*:0000000000000002 nrk_kernel_stk_ptr
                            *COM*:0000000000000080 nrk_idle_task_stk
                            *COM*:0000000000000004 _nrk_signal_list

UNDEFINED SYMBOLS
rf_security_set_ctr_counter
rf_auto_ack_disable
rf_auto_ack_enable
rf_addr_decode_disable
rf_addr_decode_enable
rf_addr_decode_set_my_mac
rf_security_last_pkt_status
rf_security_set_key
rf_tx_power
rf_set_cca_thresh
rf_power_up
rf_init
nrk_signal_register
nrk_event_wait
nrk_signal_create
nrk_kprintf
nrk_cur_task_TCB
nrk_kernel_error_add
rf_power_down
nrk_event_signal
rf_rx_on
rf_cca_check
rf_rx_off
nrk_wait
rf_rx_packet_nonblock
__udivmodsi4
nrk_time_get
__muluhisi3
nrk_time_compact_nanos
rf_tx_packet
rf_pll_on
_nrk_time_to_ticks
rand
__divmodhi4
__udivmodhi4
nrk_wait_until_ticks
nrk_wait_until_next_n_periods
rf_tx_packet_resend
nrk_time_sub
nrk_wait_until_next_period
nrk_task_set_entry_function
nrk_task_set_stk
nrk_activate_task
__do_clear_bss
